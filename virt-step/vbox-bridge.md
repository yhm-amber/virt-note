<!-- <meta charset="utf-8" emacsmode="-*- markdown -*-"> <link rel="stylesheet" href="https://casual-effects.com/markdeep/latest/journal.css?"> -->

# ã€VMã€‘åŸºäºŽ VirtualBox çš„æ¡¥æŽ¥è™šæœºåˆ›å»º

## æ¦‚è¿°

### åœºæ™¯

æœ‰ä¸€å°èµ„æºå¾ˆå¤šçš„æœåŠ¡å™¨ï¼ˆ `10.28.3.14/24 by 10.28.3.254` ï¼‰ï¼ŒçŽ°åœ¨å‘¢ï¼Œä¸æ˜¯ç›´æŽ¥åœ¨è¿™ä¸ªè£¸æœºçš„ç³»ç»Ÿä¸Šåšå„ç§æ“ä½œï¼Œè€Œæ˜¯ç”¨å®ƒåˆ›å»ºè™šæœºã€‚

ç†æƒ³çš„æƒ…å†µæ˜¯åˆ›å»ºåŸºäºŽ KVM çš„è™šæœºï¼Œä½†æ˜¯ç›¸å¯¹ VBox ï¼ˆ virtual box ï¼‰è€Œè¨€åŽè€…æœ€ç®€å•ã€‚åŽè€…ä¹Ÿæ˜¯è·¨å¹³å°çš„ã€‚

æœ¬æ–‡è®°å½•ä¸€ä¸‹ä¸Šè¿°åœºæ™¯ä¸­å¦‚ä½•åŸºäºŽ VBox åˆ›å»ºæ¡¥æŽ¥çš„è™šæ‹Ÿæœºã€‚

### èµ„æºä¿¡æ¯

èŠ‚ç‚¹ `da-04` ï¼š

- IP ï¼š `10.28.3.14/24`
- Gayeway ï¼š `10.28.3.254`

ç½‘å…³æ²¡æœ‰ DHCP è‡ªåŠ¨ IP åˆ†é…ã€‚

## æ­¥éª¤

ä¸‹é¢çš„æ­¥éª¤å°½å¯èƒ½åˆä¹Žæ“ä½œçš„é¡ºåºã€‚

é€»è¾‘å…³ç³»åˆ™é€šè¿‡ä¸€äº›æ ‡æ³¨è¡¨æ˜Žâ€”â€”æ€»çš„æ¥è¯´ï¼Œè¾¾åˆ°ä¸Šé¢çš„ç›®çš„ï¼Œè¦åšå¥½ä»¥ä¸‹æ–¹é¢çš„å·¥ä½œï¼š

- è™šæœºæ“ä½œç³»ç»Ÿå®‰è£…ï¼ˆè¿™é‡Œç”¨ ISO æ˜ åƒï¼ˆå…‰ç›˜ï¼‰æ–‡ä»¶åšå®‰è£…ä»‹è´¨ï¼‰
- ç½‘ç»œè®¿é—®ï¼ˆè¿™é‡Œç”¨æ¡¥æŽ¥ï¼‰

### 0. åœ¨æœåŠ¡å™¨æ‰“å¼€ Virtual Box çš„å›¾å½¢ç•Œé¢

æ‰“å¼€ Virtual Box è½¯ä»¶çš„å‰ææ˜¯ï¼Œèƒ½å¤Ÿä½¿ç”¨ `da-04` è¿™ä¸ªæœºå™¨çš„è£¸æœºç³»ç»Ÿçš„å›¾å½¢ç•Œé¢ã€‚

ç„¶åŽï¼Œåœ¨å…¶ä¸­æ‰èƒ½ç”¨å›¾å½¢åŒ–çš„æ–¹å¼æ‰“å¼€ Virtual Box ã€‚

#### 0.1 æŽ¥å…¥èŠ‚ç‚¹ `da-04` çš„è£¸æœºç³»ç»Ÿçš„æ¡Œé¢

è¿™é‡Œä½¿ç”¨çš„æ–¹å¼æ˜¯ VNC Server ã€‚å®ƒåŸºäºŽ `tigervnc` è¿™ä¸ªè½¯ä»¶ï¼Œå¦‚æžœæ²¡æœ‰çš„è¯å¯ä»¥é€šè¿‡ `sudo zypper in -- tigervnc` å‘½ä»¤æ¥å®‰è£…ã€‚

å¯æƒœçŽ°åœ¨æˆ‘å·²ç»è£…å¥½äº†ã€‚å¹¶ä¸”ä¹Ÿé€šè¿‡é¦–æ¬¡è¿è¡Œè¿‡å‘½ä»¤ `vncserver` ç»™é…ç½®å¥½å¯†ç äº†ã€‚åœ¨è¿™æ¬¡çš„ç¤ºä¾‹é‡Œçš„ VNC è¿žæŽ¥å¯†ç æ˜¯ï¼š

- å¦‚æžœæƒ³è¦æ“ä½œçš„è¯å¯†ç æ˜¯ï¼š `#EDC5tgb`
- å¦‚æžœåªæ˜¯æƒ³è§‚çœ‹çš„è¯å¯†ç æ˜¯ï¼š `1234!@#$`

**åƒä¸‡ä¸è¦ç”¨ root ç”¨æˆ·æ‰§è¡Œ `vncserver` å‘½ä»¤ï¼Œè¿™ä¼šä»¥ root èº«ä»½æ‰“å¼€çš„æ¡Œé¢ï¼Œè¿™æ ·çš„æ¡Œé¢åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šå‡ºçŽ°ä¸€äº›é”™è¯¯ï¼**

ç”¨ admin èº«ä»½æ‰§è¡Œè¿™ä¸ªå‘½ä»¤å°±æ˜¯è¿™æ ·å†™ï¼š `sudo -u admin -- vncserver`

æ›´å¤šä½¿ç”¨å¸®åŠ©è¯·æ‰§è¡Œï¼š `sudo -u admin -- vncserver --help`

å‘è¿™æ ·ä¼šæ‰“å¼€ä¸€ä¸ªéœ€è¦ admin èº«ä»½ç™»å½•çš„ã€ä¸”å¤§å°ä¸º `1920x1080` çš„æ¡Œé¢ï¼š

![9fdeeb305e7a11057ce186a60e6c8d71.png](vbox-bridge.imgs/9fdeeb305e7a11057ce186a60e6c8d71.png)

æ³¨æ„ä¸­çš„ `New 'da-04:2 (admin)' desktop is da-04:2` è¿™ä¸€å¥ï¼Œè¿™é‡ŒåŒ…å«äº†å¯¹å®ƒè¿žæŽ¥çš„è¿žæŽ¥æ–¹å¼ã€‚

è¦è¿žæŽ¥åˆ°æŸä¸ªå…·ä½“çš„æ‰“å¼€ç€çš„ VNC Server æœåŠ¡ï¼Œéœ€è¦çŸ¥é“è¿™ä¸¤æ ·ä¸œè¥¿ï¼š åœ°å€ã€ç«¯å£ã€‚

åœ¨ä¸Šå›¾æˆ‘æåˆ°çš„é‚£å¥è®©ä½ æ³¨æ„åˆ°çš„è¯é‡Œï¼Œ `da-04:2` å°±æ˜¯èŽ·å–è¿™ä¸¤è€…çš„**çº¿ç´¢**ï¼š

- å…¶ä¸­ `da-04` æ˜¯ï¼š ***åœ°å€*** çš„çº¿ç´¢ã€‚ï¼ˆä¼—æ‰€å‘¨çŸ¥ï¼šæ‰€è°“åœ°å€å½“ç„¶å°±æ˜¯ä¸€ä¸ª Hostname æˆ–è€…ä¸€ä¸ª IP äº†ï¼‰
- å…¶ä¸­ `2` æ˜¯ï¼š ***ç«¯å£*** çš„çº¿ç´¢ï¼šå®ƒæ˜¯å‡ ï¼Œåˆ°æ—¶å€™è¿žæŽ¥çš„æ—¶å€™ï¼Œå®žé™…è¦è¿žçš„ç«¯å£å°±æ˜¯ `5900` åŠ å‡ â€”â€”åœ¨è¿™é‡Œï¼Œå®ƒæ˜¯ `2` ï¼Œé‚£ä¹ˆï¼Œåˆ°æ—¶å€™è¦è¿žæŽ¥è¿™ä¸ª VNC Server çš„è¯ï¼Œç«¯å£å°±åº”è¯¥æ˜¯ `5902` äº†ã€‚

ä¸‹é¢æ¼”ç¤ºä½¿ç”¨ MobaXterm ä¸­å†…ç½®çš„ VNC å®¢æˆ·ç«¯æ¥è¿žæŽ¥ï¼š

1. æ‰“å¼€ MobaXTerm ï¼Œåœ¨æœ€å·¦ä¸Šè§’ï¼Œç‚¹ [Session] æŒ‰é’®
   
   ![39c2e4e81377f40402a815c0a2456e1d.png](vbox-bridge.imgs/39c2e4e81377f40402a815c0a2456e1d.png)
   
2. åœ¨å¼¹å‡ºçš„ã€è¿žæŽ¥ç§ç±»é€‰æ‹©ç•Œé¢ã€‘é€‰æ‹© [VNC] 
   
   ![91d5c1e98afee69482d639c3791039dd.png](vbox-bridge.imgs/91d5c1e98afee69482d639c3791039dd.png)
   
3. åœ¨ã€åœ°å€ã€‘éƒ¨åˆ†è¾“å…¥ `10.28.3.14` ï¼ˆæˆ–è€…åˆ«çš„ä»»ä½•å¯¹ä½ æ¥è¯´è¿žæŽ¥ `da-04` çš„æ­£ç¡®åœ°å€ï¼‰å¹¶å¯¹ã€ç«¯å£ã€‘å³è¾¹çš„ `5900` åŠ  `2` ä½¿ä¹‹æˆä¸º `5902`
   
   ![c3044c56fdda1ecc49a7b1a61d427eaa.png](vbox-bridge.imgs/c3044c56fdda1ecc49a7b1a61d427eaa.png)
   
4. ï¼ˆå¯é€‰ï¼‰åœ¨ä¸‹é¢çš„ã€é«˜çº§ VNC è®¾ç½®ã€‘é‡Œé¢å¯ä»¥é€‰æ‹©ã€åªæ˜¯çœ‹ã€‘â€”â€”è¿™å†³å®šå¾…ä¼šå„¿ä½ è¦ç”¨å“ªä¸ªå¯†ç ä»¥åŠè¿›åŽ»åŽèƒ½ä¸èƒ½æ“ä½œè¿˜æ˜¯åªèƒ½çœ‹ï¼ˆæˆ‘è¿™é‡Œæ²¡æœ‰å‹¾é€‰æ‰€ä»¥å¾…ä¼šè¦ç”¨ã€å¦‚æžœæƒ³è¦æ“ä½œçš„è¯ã€‘çš„é‚£ä¸ªå¯†ç ï¼‰
   
   ![9fe5848f7853656c33585cb913dd233c.png](vbox-bridge.imgs/9fe5848f7853656c33585cb913dd233c.png)
   
5. ç‚¹é‚£ä¸ªã€OKã€‘å°±å¯ä»¥è¿žæŽ¥äº†ï¼ˆå®ƒä¼šé—®ä½ è¦ VNC è¿žæŽ¥çš„å¯†ç ï¼‰ï¼ˆå¯ä»¥å‹¾é€‰ã€è®°ä½å¯†ç ã€‘ï¼‰
   
   è¾“å…¥æ­£ç¡®çš„è¿žæŽ¥å¯†ç ï¼ˆè¿™é‡Œæ˜¯ `#EDC5tgb` ï¼‰**ä¹‹åŽ**å°±å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç•Œé¢
   
   ![2aa17c6902938423e26ed59ddc18a34e.png](vbox-bridge.imgs/2aa17c6902938423e26ed59ddc18a34e.png)
   
   ç„¶åŽå†æ­£å¸¸è¾“å…¥è¿™ä¸ªè£¸æœºç³»ç»Ÿé‡Œçš„ `admin` ç”¨æˆ·çš„ç™»å½•å¯†ç å†ç‚¹ã€è§£é”ã€‘å°±è¿›åŽ»äº†
   
   ![c9f1207cd2b4128d2719b0f5b509721f.png](vbox-bridge.imgs/c9f1207cd2b4128d2719b0f5b509721f.png)
   

#### 0.2 åœ¨èŠ‚ç‚¹ `da-04` çš„è£¸æœºç³»ç»Ÿçš„æ¡Œé¢æ‰“å¼€ Virtual Box

ç‚¹æ¡Œé¢å·¦ä¸‹è§’çš„ã€MENUã€‘å¹¶è¾“å…¥ `vm` æœç´¢

![3469f969965ca7ebef3b4161ebf0e025.png](vbox-bridge.imgs/3469f969965ca7ebef3b4161ebf0e025.png)

è¿™æ—¶å€™ï¼Œä½ ä¼šçœ‹åˆ°é‚£ä¸ªè“è‰²çš„å›¾æ ‡ï¼Œé™¤éžä½ æ²¡å®‰è£… Virtual Box ã€‚ï¼ˆæ²¡å®‰çš„è¯ç”¨ `zypper in` å‘½ä»¤å®‰ä¸€ä¸‹å°±å¥½ï¼‰

ç‚¹å®ƒï¼Œå°±èƒ½ä»Žå›¾å½¢ç•Œé¢æ‰“å¼€ Virtual Box çš„ GUI ç•Œé¢ã€‚

***çœ‹åˆ°ä¸‹é¢è¿™æ ·å°±æ˜¯æˆåŠŸäº†*** ï¼š

![7ab4a355d7578cad2dcdc31189d91341.png](vbox-bridge.imgs/7ab4a355d7578cad2dcdc31189d91341.png)

***åœ¨è¿™é‡Œå¯èƒ½å‡ºçŽ°çš„é—®é¢˜*** ï¼ˆæ²¡å‡ºçŽ°å°±ç•¥è¿‡è¿™éƒ¨åˆ†ï¼‰ï¼š

- æŠ¥é”™è¯´ä¸å±žäºŽç”¨æˆ·ç»„ï¼Œè®©ä½ ä¸ºè¯¥ç”¨æˆ·æ·»åŠ ç”¨æˆ·ç»„å¹¶æ³¨é”€é‡æ–°ç™»é™†ï¼ˆä¸€èˆ¬æ˜¯åªæœ‰ç¬¬ä¸€æ¬¡æ‰ä¼šè¿™æ ·ï¼‰ï¼š
  
  ![7fc7237c13b283c5f44eadb11c52f1f0.png](vbox-bridge.imgs/7fc7237c13b283c5f44eadb11c52f1f0.png)
  
  è§£å†³åŠžæ³•ï¼š
  
  1. ä¸ºå½“å‰ç”¨æˆ·ï¼ˆadminï¼‰å¢žåŠ è¿™ä¸ªç”¨æˆ·ç»„ï¼š
     
     ![66dee33b6c7280aae3ae72156da32443.png](vbox-bridge.imgs/66dee33b6c7280aae3ae72156da32443.png)
     
  2. ç„¶åŽï¼Œç‚¹ã€MENUã€‘å¹¶æ³¨é”€ï¼š
     
     èœå•é‡Œç‚¹è¿™ä¸ªç”µæºæŒ‰é’®
     
     ![edd289ca762b552c5ac3ffa0d8d901a7.png](vbox-bridge.imgs/edd289ca762b552c5ac3ffa0d8d901a7.png)
     
     ç„¶åŽç‚¹å¼¹æ¡†é‡Œçš„ã€æ³¨é”€ã€‘
     
     ![d5d7c489d78d2f7684fd7114b6e364e8.png](vbox-bridge.imgs/d5d7c489d78d2f7684fd7114b6e364e8.png)
     
     å°±æ³¨é”€å¥½äº†ã€‚
     
  3. æ³¨é”€åŽå°±é»‘å±äº†ã€‚æˆ‘ä»¬éœ€è¦å…³æŽ‰åŽŸæ¥é‚£ä¸ª VNC Server ï¼ˆå› ä¸ºç”¨ä¸åˆ°äº†ï¼‰ï¼Œå¹¶é‡æ–°æ‰“å¼€ä¸€ä¸ªã€‚
     
     å…ˆåœ¨ admin çš„å‘½ä»¤è¡Œç•Œé¢åˆ—å‡ºéƒ½æ‰“å¼€äº†å“ªäº› VNC Server ï¼š
     
     ![0ac5c22fe0c32970de11d32c937c9b9d.png](vbox-bridge.imgs/0ac5c22fe0c32970de11d32c937c9b9d.png)
     
     æˆ–ï¼Œåœ¨åˆ«çš„ç”¨æˆ·ä¸‹çš„è¯å°±è¦å¤šå†™å‰é¢çš„ä¸€éƒ¨åˆ†ï¼š
     
     ![49fd32aadf98ec7e1a833273749d3028.png](vbox-bridge.imgs/49fd32aadf98ec7e1a833273749d3028.png)
     
     *ï¼ˆä¸Šé¢ä¸¤ç§æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼‰*
     *ï¼ˆåŽé¢å°±åªåŸºäºŽã€ç›´æŽ¥ä½¿ç”¨ admin ç”¨æˆ·ã€‘çš„å‘½ä»¤è¡Œç•Œé¢æ¥ç¤ºä¾‹äº†ï¼‰*
     
     åœæ­¢æˆ‘ä»¬åˆšåˆšç”¨çš„é‚£ä¸ª `2` ï¼š
     
     ![60db52253501e495da1ded2a6860d36e.png](vbox-bridge.imgs/60db52253501e495da1ded2a6860d36e.png)
     
     ç¡®è®¤ä¸€ä¸‹æ˜¯å¦åœæ­¢äº†ï¼š
     
     ![983945b7e3b20829d2287a787b75bfeb.png](vbox-bridge.imgs/983945b7e3b20829d2287a787b75bfeb.png)
     
     å¦‚å›¾å¯è§ï¼Œ `2` å·²ç»è¢«åœæ­¢äº†ã€‚
     
     å†ç”¨ admin åˆ›å»º VNC Server ï¼š
     
     ![d63cfac875cd8788ac756564b1328bf9.png](vbox-bridge.imgs/d63cfac875cd8788ac756564b1328bf9.png)
     
     ï¼ˆå¯é€‰ï¼‰å¯ä»¥å†çœ‹ä¸€çœ¼æ˜¯å¦åˆ›å»ºå‡ºæ¥äº†ï¼š
     
     ![9f07d7700c3969ec00c0427f4ce965f0.png](vbox-bridge.imgs/9f07d7700c3969ec00c0427f4ce965f0.png)
     
     ç„¶åŽè¿˜æ˜¯ç”¨ã€è€åŠžæ³•ã€‘ï¼ˆè§ä¸Šæ–‡ï¼‰è¿žæŽ¥è¿™ä¸ªè¢«åˆ›å»ºçš„ `da-04:2` VNC Server ï¼Œè¾“å…¥å¯†ç åŽæ‰“å¼€ Virtual Box å°±å¥½äº†ã€‚
     




### 1. åˆ›å»ºè™šæ‹Ÿæœº

åˆ›å»ºè™šæœºå¹¶è®¾ç½®ç½‘ç»œå’Œå®‰è£…ä»‹è´¨ã€‚




#### 1.1 æ–°å»º

ç‚¹ã€æ–°å»ºã€‘

![ff6d944703a78df09e0655003a9bc185.png](vbox-bridge.imgs/ff6d944703a78df09e0655003a9bc185.png)

å‡ºçŽ°å¦‚ä¸‹ç”»é¢ï¼š

![ea9e363b2fc9d517843edbe274db106c.png](vbox-bridge.imgs/ea9e363b2fc9d517843edbe274db106c.png)

ç›´æŽ¥å°±æ­¤è¾“å…¥ä¸€ä¸ªè™šæœºçš„åç§°å°±å¥½ï¼š

![e72be9d6a7afef535013a11fa1a8db5a.png](vbox-bridge.imgs/e72be9d6a7afef535013a11fa1a8db5a.png)

**ä¸‹é¢çš„ç±»åž‹å’Œç‰ˆæœ¬ä¼šæ™ºèƒ½åœ°æ ¹æ®ä½ çš„æ˜Žæ˜Žè‡ªåŠ¨é€‰æ‹©ï¼**

ç‚¹ã€ä¸‹ä¸€æ­¥ã€‘

![26abab674de70e77f1da6ab8863b361e.png](vbox-bridge.imgs/26abab674de70e77f1da6ab8863b361e.png)

æˆ‘æŠŠå†…å­˜è®¾ç½®ä¸º `4096` ï¼ˆè¿™ä¸ªèƒ½åŽç»­è¯¥ï¼‰ï¼Œå†ã€ä¸‹ä¸€æ­¥ã€‘

![8d37af8df08a952bbb6d68f0ae26a10b.png](vbox-bridge.imgs/8d37af8df08a952bbb6d68f0ae26a10b.png)

ä¸çŸ¥é“é€‰å“ªä¸ªçš„è¯å°±ç”¨é»˜è®¤çš„ã€çŽ°åœ¨åˆ›å»ºè™šæ‹Ÿç¡¬ç›˜ã€‘ï¼Œç‚¹ã€åˆ›å»ºã€‘

![f1050f4c81c7c114f7ccd018d869653c.png](vbox-bridge.imgs/f1050f4c81c7c114f7ccd018d869653c.png)

![76559938e2d7c97ef1e890fa296959eb.png](vbox-bridge.imgs/76559938e2d7c97ef1e890fa296959eb.png)

ä¸Šé¢ä¸¤é¡µä¸çŸ¥é“æ€Žä¹ˆé€‰å°±ç”¨å›¾ä¸­é»˜è®¤çš„ï¼Œã€ä¸‹ä¸€æ­¥ã€‘

![8a440f7e4ea2952bdd9d4172dcbc28c5.png](vbox-bridge.imgs/8a440f7e4ea2952bdd9d4172dcbc28c5.png)

è¿™é‡Œåªç®¡æ ¹æ®ä½ çš„éœ€è¦æ›´æ”¹è¿™ä¸ªç¡¬ç›˜çš„æœ€å¤§å¤§å°å°±å¥½ï¼Œæˆ‘ç»™æ”¹æˆ `16 GB` 

![d0f06f2a755755c26295c5ac47d01b50.png](vbox-bridge.imgs/d0f06f2a755755c26295c5ac47d01b50.png)

ç‚¹ã€åˆ›å»ºã€‘

![34304ef77a4f8335a0095b84d3dc326b.png](vbox-bridge.imgs/34304ef77a4f8335a0095b84d3dc326b.png)

ä¸€ä¸ªè™šæœºå°±ã€æ–°å»ºã€‘å¥½äº†ã€‚




#### 1.2 è®¾ç½®å®‰è£…ç›˜å’Œç½‘ç»œ

ä¸Šé¢åˆ›å»ºå¥½äº†ï¼Œå¯¹å§ï¼Ÿä¸è¦å¯åŠ¨å®ƒï¼Œåæ­£å¯åŠ¨äº†ä¹Ÿä»€ä¹ˆéƒ½åšä¸äº†ã€‚

ç‚¹ã€è®¾ç½®ã€‘

![52a47e0c55179f1d84b513fb724a4251.png](vbox-bridge.imgs/52a47e0c55179f1d84b513fb724a4251.png)




##### 1.2.1 æ’å…¥å®‰è£…ç›˜

å·¦è¾¹ï¼Œç‚¹ã€å­˜å‚¨ã€‘

![a2a897a3f312f6ec043e6400951a1300.png](vbox-bridge.imgs/a2a897a3f312f6ec043e6400951a1300.png)

å¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸¤ä¸ªå›¾æ ‡ï¼Œã€æ²¡æœ‰ç›˜ç‰‡ã€‘å·¦è¾¹æ˜¯å…‰ç›˜å½¢çŠ¶çš„å›¾æ ‡ï¼Œã€xxx.vdiã€‘å·¦è¾¹æ˜¯æœºæ¢°ç¡¬ç›˜å½¢çŠ¶çš„å›¾æ ‡ã€‚

è¿™é‡Œæˆ‘ä»¬è¦ç”¨æ¥å®‰è£…ç³»ç»Ÿçš„ä»‹è´¨æ˜¯ ISO æ ¼å¼çš„å…‰ç›˜æ–‡ä»¶ã€‚

ç‚¹ã€æ²¡æœ‰ç›˜ç‰‡ã€‘è¿™å‡ ä¸ªå­—ï¼š

![75559bb0b700adc8c98cb14f8bf129eb.png](vbox-bridge.imgs/75559bb0b700adc8c98cb14f8bf129eb.png)

å³è¾¹æœ‰ä¸€ä¸ªè“è‰²çš„å°å…‰ç›˜ï¼Œç‚¹å®ƒï¼š

![7eaf7c25413de88449b520aa449219ed.png](vbox-bridge.imgs/7eaf7c25413de88449b520aa449219ed.png)

ç¬¬ä¸€æ¬¡çš„è¯ï¼Œå¿…é¡»ç‚¹ç¬¬ä¸€é¡¹ï¼Œå°±ä¼šå¼¹å‡ºçª—å£ï¼š

![7ef06d79fa52623a15ab1b8b0c658927.png](vbox-bridge.imgs/7ef06d79fa52623a15ab1b8b0c658927.png)

è¿™ä¸ªç•Œé¢å¯ä»¥åˆ›å»ºã€å…‰ç›˜æ–‡ä»¶ã€‘ï¼Œä¹Ÿå¯åŠ å…¥çŽ°æœ‰çš„ã€å…‰ç›˜æ–‡ä»¶ã€‘ã€‚

ç‚¹ã€æ³¨å†Œã€‘å¯ä»¥åŠ å…¥çŽ°æœ‰çš„ã€å…‰ç›˜æ–‡ä»¶ã€‘ï¼Œè¿™æ˜¯ç‚¹ã€æ³¨å†Œã€‘åŽå‡ºçŽ°çš„é€‰æ‹©æ–‡ä»¶çš„çª—å£ï¼š

![b01a80f83421d04ca11a733a5263af6a.png](vbox-bridge.imgs/b01a80f83421d04ca11a733a5263af6a.png)

é€‰æ‹©ä½ æƒ³è¦ç”¨çš„ ISO æ ¼å¼çš„å…‰ç›˜æ–‡ä»¶ï¼Œç‚¹ã€æ‰“å¼€ã€‘ï¼Œå°±ä¼šå®Œæˆã€æ·»åŠ ã€‘ã€‚

è¿™é‡Œï¼Œæˆ‘å·²ç»æŠŠé‚£ä¸ª ISO æ ¼å¼çš„æ–‡ä»¶æ·»åŠ è¿‡ä¸€æ¬¡äº†ï¼Œæ‰€ä»¥å†æ·»åŠ ä¸€æ¬¡ä¹Ÿä¸ä¼šå¢žåŠ ä»€ä¹ˆï¼š

![1bb235dfebc3c04f410cb3cb6f64f324.png](vbox-bridge.imgs/1bb235dfebc3c04f410cb3cb6f64f324.png)

è¿™ä¸ªç»¿è‰²çš„å°±æ˜¯ä½ åˆšåˆšæ·»åŠ çš„ã€‚é€‰ä¸­å®ƒï¼Œç‚¹ã€é€‰æ‹©ã€‘ï¼Œå°±ç›¸å½“äºŽç»™è¿™å°è™šæ‹Ÿæœºå™¨æ’å…¥äº†è¿™ä¸ªå…‰ç›˜ã€‚

æ’å…¥æˆåŠŸåŽå°±æ˜¯è¿™æ ·ï¼š

![fbb0921db72fb68bd176e648b9530ade.png](vbox-bridge.imgs/fbb0921db72fb68bd176e648b9530ade.png)

ä¹‹åŽå†æ–°å»ºè™šæ‹Ÿæœºï¼Œç›´æŽ¥é€‰æ‹©è¿™ä¸ªå°±å¥½ï¼ˆè¿™ä¸ªä¹Ÿæ˜¯æ·»åŠ åŽæ‰æœ‰äº†çš„ï¼‰ï¼š

![68a9f09abf575b4c93cd9a343d900d24.png](vbox-bridge.imgs/68a9f09abf575b4c93cd9a343d900d24.png)

æƒ³è¦æ›´æ¢å¦ä¸€å¼ å…‰ç›˜ï¼ˆå¦ä¸€ä¸ªå…‰ç›˜æ–‡ä»¶ï¼‰çš„è¯ï¼Œç‚¹è¿™é‡Œçš„ã€ç§»é™¤è™šæ‹Ÿç›˜ã€‘ï¼Œç„¶åŽå†é€‰æ‹©åˆ«çš„å·²æ·»åŠ çš„ï¼ˆæˆ–è€…æ·»åŠ åˆ«çš„ï¼‰å°±å¥½ã€‚

åˆ°æ­¤ï¼Œå®‰è£…ç›˜çš„è™šæ‹Ÿå…‰ç›˜ï¼ˆä¹Ÿå°±æ˜¯å…‰ç›˜æ–‡ä»¶ï¼‰çš„æ’å…¥å°±å®Œæˆäº†ã€‚

![b04cd198077758ca8c8c2289e8eca3c8.png](vbox-bridge.imgs/b04cd198077758ca8c8c2289e8eca3c8.png)




##### 1.2.2 é…ç½®æ¡¥æŽ¥ç½‘å¡

å·¦è¾¹ï¼Œç‚¹ã€ç½‘ç»œã€‘

![0f15a5288fbf8f17a65b09f26713d76e.png](vbox-bridge.imgs/0f15a5288fbf8f17a65b09f26713d76e.png)

éšä¾¿æ›´æ”¹å“ªä¸ªç½‘å¡éƒ½å¥½ï¼Œè¿™é‡Œæˆ‘ç‚¹ã€ç½‘å¡2ã€‘

![8d81fafaa7e310dbf5d8e9c781fcf6a2.png](vbox-bridge.imgs/8d81fafaa7e310dbf5d8e9c781fcf6a2.png)

ç‚¹ã€å¯ç”¨ç½‘ç»œè¿žæŽ¥ã€‘ç›¸å½“äºŽæ’ä¸Šäº†ä¸€ä¸ªæ–°çš„ç½‘å¡ã€‚

ï¼ˆè¿™é‡Œçš„ä¸€ä¸ªç½‘å¡å°±æ˜¯ä¸€ä¸ªç½‘å£ã€‚ï¼‰

è¿žæŽ¥æ–¹å¼é€‰æ‹©ã€æ¡¥æŽ¥ã€‘

![849b3becbe0119029bcbe1674ab522b9.png](vbox-bridge.imgs/849b3becbe0119029bcbe1674ab522b9.png)

ä¸‹é¢çš„ã€ç•Œé¢åç§°ã€‘ä¼šå˜å¾—å¯é€‰ï¼Œè¿™é‡Œé€‰æ‹©ç¬¬ä¸€ä¸ªï¼š

![2c770154d940b8644852399b6a881d46.png](vbox-bridge.imgs/2c770154d940b8644852399b6a881d46.png)

ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥åœ¨ `da-04` çš„è£¸æœºç³»ç»Ÿæ‰§è¡Œ `nmcli c s` å‘½ä»¤çœ‹ä¸‹ï¼š

![d5104d8758e0dcc7f4eb7e6d7ae1c6d2.png](vbox-bridge.imgs/d5104d8758e0dcc7f4eb7e6d7ae1c6d2.png)

å…¶ä¸­ã€æœ‰çº¿è¿žæŽ¥ 1ã€‘å¯¹åº”çš„ DEVICE ï¼ˆè®¾å¤‡ï¼‰å°±æ˜¯å« `eth0` è¿™ä¹ˆä¸ªåå­—ã€‚**å®ƒä»£è¡¨çš„æ˜¯è¿™å°è£¸é‡‘å±žå®žé™…æ’ç€ç½‘çº¿çš„é‚£ä¸ªç½‘å£**ã€‚

æ¡¥æŽ¥å°±æ˜¯è¯´è¦é€šè¿‡å®ƒæ¥è¿žä¸Šè¿™ä¸ª `da-04` æ‰€è¿žçš„ GateWay ï¼ˆç½‘å…³ï¼‰ï¼Œä»Žè€Œä½¿è¿™ä¸ªè™šæœºå¯è¢«åˆ†é…ä¸º**åŒå­ç½‘**å†…çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚

å›žåˆ°å›¾å½¢ç•Œé¢ã€‚

ã€é«˜çº§ã€‘é‡Œæˆ‘ä¹Ÿä¸çŸ¥é“æœ‰å•¥ç”¨ï¼Œæˆ‘æ²¡åŠ¨ï¼Œå®ƒæ ·å­å°±æ˜¯è¿™ä¸ªæ ·å­ã€‚ã€‚ã€‚

ç‚¹ã€ç¡®å®šã€‘ï¼Œå®Œæˆã€æ¡¥æŽ¥ç½‘å¡ã€‘çš„è®¾ç½®ã€‚




##### 1.2.3 æ£€æŸ¥ç»“æžœ

åœ¨è¿™å°è™šæœºçš„æ¬¢è¿Žç•Œé¢ï¼Œå¾€ä¸‹æ»‘ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬è®¾ç½®è¿‡çš„ã€å­˜å‚¨ã€‘å’Œã€ç½‘ç»œã€‘ä¸­å·²ç»ç”Ÿæ•ˆçš„è®¾ç½®ï¼š

![56b948cc4b60649126d299bdf6bfbefe.png](vbox-bridge.imgs/56b948cc4b60649126d299bdf6bfbefe.png)

ã€å®‰è£…ä»‹è´¨ã€‘å’Œã€æ¡¥æŽ¥ç½‘ç»œã€‘åœ¨æœ¬ç¤ºä¾‹ä¸­æ˜¯å¿…é¡»çš„ã€‚

å¦‚æžœä½ è¿˜æƒ³è®¾ç½®åˆ«çš„ï¼Œæ¯”å¦‚å…±äº«æ–‡ä»¶å¤¹ï¼Œå¯è‡ªè¡Œå°è¯•ã€‚




### 2. å®‰è£…




#### 2.1 åœ¨è™šæ‹Ÿæœºé‡Œå¯åŠ¨å®‰è£…ä»‹è´¨

**ä¸Šä¸€æ­¥çš„è®¾ç½®éƒ½å®ŒæˆåŽ**ï¼Œç‚¹ã€å¯åŠ¨ã€‘ï¼š

![32895f813e7a6ea4c701dfcc5dfb5e99.png](vbox-bridge.imgs/32895f813e7a6ea4c701dfcc5dfb5e99.png)

ä¹‹åŽè·Ÿä¸€èˆ¬çš„ç³»ç»Ÿå®‰è£…ç±»ä¼¼äº†ã€‚

ç‚¹ã€å¯åŠ¨ã€‘æ˜¯ä¸€ç§ä¸´æ—¶æ€§çš„è¡Œä¸ºï¼Œå› ä¸ºè¿™ä¼šè®©è™šæœºè¿›ç¨‹å˜æˆè¿™ä¸ªæ¡Œé¢è¿›ç¨‹ï¼ˆåœ¨æœ¬æ–‡ä¹Ÿå°±æ˜¯å…³æŽ‰å¯¹åº”çš„ VNC Server è¿›ç¨‹ï¼‰çš„å­è¿›ç¨‹ï¼ˆæˆ–è€…è¯´å­å­å­...è¿›ç¨‹ï¼‰ï¼Œè¿™æ ·çš„è¯ï¼Œå…³æŽ‰è¿™ä¸ª VNC Server å°±ä¼šå¯¼è‡´è¿™ä¸ªè™šæœºè¢«å¼‚å¸¸å…³é—­ã€‚

æ›´åˆé€‚çš„æ–¹å¼æ˜¯ã€åˆ†ç¦»å¼å¯åŠ¨ã€‘ï¼š

![f3082b26f2e42651929dc573063fc415.png](vbox-bridge.imgs/f3082b26f2e42651929dc573063fc415.png)

è¿™ç§æ—¶å€™ï¼Œå†å…³é—­è™šæœºç•Œé¢ï¼Œå°±ä¼šå¤šå‡ºä¸€ä¸ªã€ç»§ç»­ä¿æŒåŽå°è¿è¡Œã€‘çš„é€‰é¡¹æ¥ï¼š

![091eafa102e70aa384571288315ee4cf.png](vbox-bridge.imgs/091eafa102e70aa384571288315ee4cf.png)

å¹¶ä¸”å…³é—­ VNC Server ä¹Ÿä¸ä¼šè®©è¿™ä¸ªè™šæœºå…³é—­ã€‚å› ä¸ºè¿™ç§æ–¹å¼ä¸‹ï¼Œè™šæœºè¿›ç¨‹å°±æ˜¯ Virtual Box çš„å®ˆæŠ¤è¿›ç¨‹çš„å­è¿›ç¨‹äº†ã€‚

!!! Note
    
    è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦ç‚¹ä¸€ä¸‹é¼ æ ‡æ‰èƒ½æ“ä½œè™šæ‹Ÿæœºé‡Œé¢ï¼Œä½†è¿™æ ·ä¸€æ¥ï¼Œé¼ æ ‡åœ¨å¤–é¢å°±ä¸èƒ½ç”¨äº†ã€‚
    
    æˆ‘æŠŠå¿«æ·é”®è®¾ç½®æˆäº† `F7` ï¼ŒæŒ‰ä¸‹ `F7` å°±èƒ½é‡æ–°åœ¨è™šæ‹Ÿæœºå¤–èŽ·å¾—é¼ æ ‡ï¼Œä½†è¿™æ ·å°±ä¸èƒ½æ“ä½œè™šæ‹Ÿæœºäº†ã€‚
    
    è¿™ä¸ªåœ¨è¿™é‡Œçš„å…¨å±€è®¾ç½®é‡Œå¯ä»¥æ›´æ”¹ï¼š
    
    ![86daf3ba83eb4b13559705083b9c967c.png](vbox-bridge.imgs/86daf3ba83eb4b13559705083b9c967c.png)
    
    ![a17ab005db86928f31799dbad2e0590f.png](vbox-bridge.imgs/a17ab005db86928f31799dbad2e0590f.png)
    
    ã€ä¸»æœºç»„åˆé”®ã€‘å°±æ˜¯å¯¹å®ƒçš„è®¾ç½®ã€‚
    
    å®ƒæœ¬æ¥æ˜¯ã€å³ Ctrlã€‘ï¼Œç„¶è€Œå› ä¸º VNC ä¸ä¼šä¼ é€’è¿™ä¸ªæ¡ˆä»¶åŠ¨ä½œç»™è¿œæ–¹çš„ `da-04` çš„æ¡Œé¢ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œè¦æ”¹æˆä¸€ä¸ªèƒ½ç”¨çš„ã€‚
    
    èƒ½ï¼ˆåœ¨è¿™ä¸ª VNC è¿žæŽ¥ä¸‹ï¼‰è®¾ç½®ä¸Šï¼Œå°±èƒ½ç”¨ã€‚
    
    è™šæ‹Ÿæœºç•Œé¢çš„å³ä¸‹è§’è¿™é‡Œï¼Œä¹Ÿæœ‰ã€è¿™ä¸ªå¿«æ·é”®æ˜¯å•¥ã€‘çš„æç¤º:
    
    ![f7281f235a3e1781887da32eacc96b8f.png](vbox-bridge.imgs/f7281f235a3e1781887da32eacc96b8f.png)
    




#### 2.2 å®‰è£…é…ç½®

å› ä¸ºä¸æ‰“ç®—å®‰è£…æ¡Œé¢ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨é»˜è®¤çš„è‹±æ–‡è¯­è¨€å®‰è£…ï¼ˆä¸ç„¶åŽé¢å¯èƒ½ä¼šæœ‰ä¸€äº›ä¹Ÿä¸æ˜¯ä¸èƒ½è§£å†³çš„å°éº»çƒ¦ï¼‰ï¼š

![53aa89f0c22d78c8535e7a3a48742a1a.png](vbox-bridge.imgs/53aa89f0c22d78c8535e7a3a48742a1a.png)

*ï¼ˆå¦‚æžœä½ ç”¨ä¸­æ–‡å®‰è£…å¥½ç³»ç»ŸåŽå†å¢žåŠ æ–°çš„ç½‘å¡ï¼Œåœ¨ `nmcli c` çœ‹åˆ°çš„è¾“å‡ºé‡Œå°±ä¼šå‡ºçŽ°æ–¹å—ä¹±ç ï¼Œå…¶å®žå°±æ˜¯ä¸­æ–‡â€œæœ‰çº¿è¿žæŽ¥â€å››ä¸ªå­—ã€‚ï¼‰*
*ï¼ˆæ‰€ä»¥ï¼Œå¦‚æžœåªéœ€è¦æŒ‰ç…§æˆ‘è¿™ä¸ªæ­¥éª¤èµ°ä¸€éçš„è¯ï¼Œé€‰æ‹©ä¸­æ–‡åˆ™å¹¶ä¸ä¼šå‡ºçŽ°æˆ‘è¯´çš„è¿™ä¸ªéº»çƒ¦ã€‚ï¼‰*

æœ¬ç¤ºä¾‹è®¾ç½®ä»¥ä¸‹å‡ é¡¹ï¼š

- ç½‘ç»œï¼š
  
  ![cc0f8e8798bcb9052fba08554f09baa8.png](vbox-bridge.imgs/cc0f8e8798bcb9052fba08554f09baa8.png)
  
  åœ¨é‡Œé¢ï¼Œè®¾ç½® Hostname ä¸º `cent2` ï¼Œã€Applyã€‘ã€‚
  
  ç„¶åŽï¼Œé€‰æ‹©ç¬¬äºŒä¸ªè®¾å¤‡ï¼š
  
  ![46aad55eeead5321c7854f5c4db73157.png](vbox-bridge.imgs/46aad55eeead5321c7854f5c4db73157.png)
  
  ç‚¹ã€è®¾ç½®ï¼ˆ Configure ï¼‰ã€‘
  
  ![4d989d8c3c692aa3a3d35eb9e9827cf8.png](vbox-bridge.imgs/4d989d8c3c692aa3a3d35eb9e9827cf8.png)
  
  ç‚¹ã€ IPv4 Settings ã€‘ï¼Œã€Methodã€‘é€‰ã€Manualã€‘ï¼š
  
  ![ad77fe718eb79cd90f926c61384c2908.png](vbox-bridge.imgs/ad77fe718eb79cd90f926c61384c2908.png)
  
  ç„¶åŽç‚¹ã€Addã€‘
  
  ![b9b66775c7182fb0c78941b7f459b955.png](vbox-bridge.imgs/b9b66775c7182fb0c78941b7f459b955.png)
  
  æœ¬ç¤ºä¾‹éœ€è¦æ‰‹åŠ¨åˆ†é… IP ï¼Œè¯·ç¡®ä¿ä½ è¿™é‡Œå†™çš„ IP æ˜¯æ²¡è¢«å ç”¨çš„ï¼š
  
  ![730d8b1c4d15a70daba263fed454a5e4.png](vbox-bridge.imgs/730d8b1c4d15a70daba263fed454a5e4.png)
  
  !!! Note
      *æ³¨æ„ï¼šè¾“å…¥ IP çš„æ—¶å€™ï¼Œé¼ æ ‡å¯èƒ½ä¸å¥½ä½¿ã€‚æŒ‰ `TAB` é”®å¯ä»¥åˆ‡ä¸ºç¼–è¾‘ä¸‹ä¸€ä¸ªè¾“å…¥æ¡†ï¼ŒæŒ‰ `Shift + TAB` é”®å¯ä»¥åˆ‡æ¢ä¸ºç¼–è¾‘ä¸Šä¸€ä¸ªè¾“å…¥æ¡†ã€‚*
  
  ä¸‹é¢çš„ã€ DNS æœåŠ¡å™¨ä»¬ã€‘æ¡†é‡Œï¼Œå¯ä»¥åƒæˆ‘è¿™æ ·å†™ï¼š
  
  ![af26a7091aab546fb5fde1d462df160d.png](vbox-bridge.imgs/af26a7091aab546fb5fde1d462df160d.png)
  
  æˆ–è€…æ ¹æ®ä½ çš„éœ€è¦ä½¿ç”¨ä¸€äº›åˆ«çš„å…¬å…±æˆ–ç§æœ‰ DNS ã€‚
  
  ç‚¹ã€SAVEã€‘ä¿å­˜è®¾ç½®
  
  ![0c9f972788f2eab66a461ab62419814d.png](vbox-bridge.imgs/0c9f972788f2eab66a461ab62419814d.png)
  
  ç„¶åŽä¸‹ä¸€ä¸ªç•Œé¢ï¼ŒæŠŠã€OFFã€‘ç‚¹æˆã€ONã€‘å°±ç›¸å½“äºŽå¯åŠ¨è¿™ä¸ªè®¾å¤‡çš„ç½‘ç»œè¿žæŽ¥ï¼š
  
  ![5aa7d2d2451e9b66fe5bb9752f7e26cc.png](vbox-bridge.imgs/5aa7d2d2451e9b66fe5bb9752f7e26cc.png)
  
  ç‚¹å·¦ä¸Šçš„ã€Doneã€‘é€€å›žåˆ°ä¹‹å‰é¡µé¢ã€‚
  
- æ—¶åŒºï¼š
  
  ![a0567741959897d13cde580a650733ae.png](vbox-bridge.imgs/a0567741959897d13cde580a650733ae.png)
  
  æ²¡æœ‰ç½‘ç»œä¹Ÿå¯ä»¥è®¾ç½®ã€‚
  
  ![661509bea387ed0774304a7f6a7797a9.png](vbox-bridge.imgs/661509bea387ed0774304a7f6a7797a9.png)
  
  è®©çº¢è‰²æ ‡è‡´è½åˆ°ä½ çš„æ‰€åœ¨åœ°é™„è¿‘ï¼ˆè¿™é‡Œæ˜¯åŒ—äº¬ï¼‰ï¼Œå®ƒä¼šè‡ªåŠ¨é€‰æ‹©é™„è¿‘çš„åŸŽå¸‚ã€‚ï¼ˆåŒ—äº¬çš„é™„è¿‘çš„æ—¶åŒºåŸŽå¸‚å°±æ˜¯ã€äºšæ´²/ä¸Šæµ·ã€‘äº†ï¼‰
  
  å¦‚æžœè¿žé€šäº†ç½‘ç»œï¼Œè¿˜å¯ä»¥é…ç½®ä¸€ä¸‹è‡ªå·±çš„ NTP æœåŠ¡å™¨ï¼š
  
  ![6a8e1e07d8002e4b6ce9ab732e043491.png](vbox-bridge.imgs/6a8e1e07d8002e4b6ce9ab732e043491.png)
  
  ä¸‹é¢å››ä¸ªæ˜¯æœ¬æ¥æœ‰çš„ï¼Œä¸Šé¢æ¡†é‡Œæˆ‘åˆšåˆšå†™çš„æ˜¯ã€å›½å®¶æŽˆæ—¶ä¸­å¿ƒã€‘çš„åœ°å€ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®æˆä½ éœ€è¦çš„æ ·å­ï¼ˆæ¯”å¦‚å†…ç½‘çš„ NTP æœåŠ¡çš„åœ°å€ï¼‰ï¼š
  
  ![337331b97775a090b7eef85b25c34e55.png](vbox-bridge.imgs/337331b97775a090b7eef85b25c34e55.png)
  
  ç‚¹å³è¾¹åŠ å·å³å¯æ·»åŠ ã€‚ä¸æƒ³å®ƒç”Ÿæ•ˆçš„é‚£äº›ï¼Œå°±å–æ¶ˆã€Useã€‘åˆ—çš„å‹¾é€‰ï¼š
  
  ![c14b87b3e716ce632aef54e692a2fe86.png](vbox-bridge.imgs/c14b87b3e716ce632aef54e692a2fe86.png)
  
  *ï¼ˆè¿™é‡Œç»¿çš„å°±æ˜¯å¯è¿žé€šâ€”â€”æ‰€ä»¥è¿™é‡Œä¹Ÿèƒ½ç”¨äºŽéªŒè¯ç½‘ç»œé…ç½®ï¼‰*
  
  ç„¶åŽç‚¹ã€OKã€‘åº”ç”¨è®¾ç½®ã€‚
  
  ç‚¹å·¦ä¸Šè§’ã€Doneã€‘å›žåˆ°ä¹‹å‰ç•Œé¢ã€‚
  
  å›žåˆ°ä¹‹å‰ç•Œé¢ï¼Œå¯çœ‹åˆ°æ”¹åŠ¨ï¼š
  
  ![9400c2a7a048001853d644c5f3ab6973.png](vbox-bridge.imgs/9400c2a7a048001853d644c5f3ab6973.png)
  
- ç£ç›˜åˆ†åŒºè®¾ç½®
  
  ![bd8878b497b1bde24fb8796a138d6082.png](vbox-bridge.imgs/bd8878b497b1bde24fb8796a138d6082.png)
  
  è¿™é‡Œå¯ä»¥è®¾ç½®åˆ†åŒºï¼Œæˆ‘ä¸éœ€è¦è‡ªå®šä¹‰åˆ†åŒºï¼Œæ‰€ä»¥ç‚¹è¿›åŽ»åŽç‚¹å·¦ä¸Šè§’çš„ã€Doneã€‘å›žåˆ°ä¹‹å‰ç•Œé¢å°±å¥½äº†ï¼š
  
  ![4e313c07d9cbff95d24016bf542142bd.png](vbox-bridge.imgs/4e313c07d9cbff95d24016bf542142bd.png)
  
  å¦‚æžœè¿™ä¸ªç›˜æ˜¯æ–°ç›˜ï¼ˆå°±æ˜¯æŒ‰ç…§ä¸Šé¢æ­¥éª¤æ–°å»ºçš„ç›˜ï¼‰ï¼Œå›žåˆ°ä¹‹å‰ç•Œé¢åŽï¼Œç­‰å®ƒç¨åšæ£€æŸ¥ï¼Œå˜æˆè¿™æ ·å°±å¥½äº†ï¼š
  
  ![e985d22b2d4a5c3681c6e251b179a42c.png](vbox-bridge.imgs/e985d22b2d4a5c3681c6e251b179a42c.png "e985d22b2d4a5c3681c6e251b179a42c.png")
  
  *å¦‚æžœæ˜¯é‡Œé¢æœ‰ä¸œè¥¿çš„ç›˜ï¼Œç‚¹ã€Doneã€‘çš„æ—¶å€™ä¼šé—®ä½ æ˜¯å¦æ¸…é™¤ä»¥åŠæ¸…é™¤å“ªäº›åˆ†åŒºã€‚æœ¬ç¤ºä¾‹ä¸å¯¹è¿™ç§æƒ…å†µå†åšæ¼”ç¤ºã€‚*
  

ä¸Šé¢å‡ é¡¹è®¾ç½®å®ŒåŽï¼Œç‚¹å³ä¸‹è§’çš„ã€å¼€å§‹å®‰è£…ã€‘å°±ä¼šå¼€å§‹å®‰è£…ï¼š

![c1128aeba070a498594e4363de7c3f71.png](vbox-bridge.imgs/c1128aeba070a498594e4363de7c3f71.png)

åœ¨è¿™é‡Œéœ€è¦å°½å¿«è®¾ç½®å®Œ root çš„å¯†ç ä»¥åŠç®¡ç†å‘˜ç”¨æˆ·ï¼š

![46f2c2a672fbb0d8c0f0ddb5e631bb8e.png](vbox-bridge.imgs/46f2c2a672fbb0d8c0f0ddb5e631bb8e.png)

è®¾ç½®å¥½å°±æ˜¯è¿™ä¸ªæ ·

![46611f03f3f10f688aca2f0d3ce365d7.png](vbox-bridge.imgs/46611f03f3f10f688aca2f0d3ce365d7.png)

ç­‰å¾…å®‰è£…å®Œæˆï¼ˆé»„åº•æ˜¯æç¤ºä½ è¦éµå®ˆä½¿ç”¨åè®®ï¼‰ï¼š

![ad368a7e3fea0acec25edffe4dab5210.png](vbox-bridge.imgs/ad368a7e3fea0acec25edffe4dab5210.png)

ç‚¹å³ä¸‹è§’çš„ã€é‡å¯ã€‘æ¥é‡å¯ã€‚





#### 2.3 å®‰è£…åŽéªŒè¯

é‡å¯åŽï¼Œç­‰å®ƒå˜è¿™æ ·ï¼Œå°±æ˜¯å¯åŠ¨å¥½äº†ï¼š

![554a3068599e36b182f5cab282ce3fb7.png](vbox-bridge.imgs/554a3068599e36b182f5cab282ce3fb7.png)

åˆšåˆšä¸Šé¢ä¸¤è¡Œå­—å¯ä»¥ç‚¹è“ã€Ã—ã€‘å…³æŽ‰ï¼ˆè¿™ä¿©ä¸€å¼€å§‹å°±å¯ä»¥å…³ï¼‰ã€‚

è¿™æ ·å°±æ²¡ä¸œè¥¿æŒ¡ç€äº†ã€‚è¿™æ˜¯å¯åŠ¨å¥½åŽçš„æ ·å­ï¼š

![28ef0be6a11355104658f96e1eef0748.png](vbox-bridge.imgs/28ef0be6a11355104658f96e1eef0748.png)

è®°å¾—åˆšåˆšè®¾ç½®çš„ IP å—ï¼Ÿé‚£ä¸ª `10.28.3.102/24` ã€‚

ä¸‹é¢ï¼Œç”¨éšä¾¿ä¸€å°èƒ½ `ping` é€šç½‘å…³ `10.28.3.254` çš„ç”µè„‘ï¼ˆæ¯”å¦‚è¿žå†…ç½‘åŽçš„å…¬å¸ç¬”è®°æœ¬ï¼‰ï¼Œå°è¯•å¯¹å®ƒå‘èµ· `ssh` è¿žæŽ¥ã€‚

æµ‹è¯•ç½‘ç»œï¼š

![70c662faf8c2ba687807c14db1c162a1.png](vbox-bridge.imgs/70c662faf8c2ba687807c14db1c162a1.png)

å‘èµ·è¿žæŽ¥ï¼š

![1af342777fb42615bfdfa2256661e277.png](vbox-bridge.imgs/1af342777fb42615bfdfa2256661e277.png)

å¦‚å›¾å°±æ˜¯èƒ½å¤Ÿè¿žæŽ¥ã€‚è¾“å…¥ `yes` ä¿¡ä»»è¿œç¨‹æœºå™¨å¹¶è¾“å…¥å¯†ç ï¼Œå°±æ‰“å¼€è¿žæŽ¥äº†ï¼š

![623343ed822794b75197db11ac426fef.png](vbox-bridge.imgs/623343ed822794b75197db11ac426fef.png)

ä¸‹é¢å°±å¯ä»¥ä½¿ç”¨äº†ï¼š

![c2ba45df1dcec96329962e5d1bac8208.png](vbox-bridge.imgs/c2ba45df1dcec96329962e5d1bac8208.png)






## æ€»ç»“

æœ¬æ–‡æè¿°äº†æ€Žä¹ˆç”¨æœ€ç®€å•çš„æ–¹å¼åˆ›å»ºè™šæ‹Ÿæœºå¹¶é…ç½®ä¸ºæ¡¥æŽ¥ï¼Œç„¶åŽæ¼”ç¤ºäº†æ‰“å¼€å®ƒçš„æ•ˆæžœã€‚

æœ¬æ–‡ç›®çš„åœ¨äºŽï¼Œåˆ©ç”¨è¿™æ ·ä¸€ç§ç®€å•çš„ç¤ºä¾‹æ¥ä½“çŽ°ï¼Œå¼€å¯ä¸€ä¸ªæ¡¥æŽ¥è™šæ‹Ÿæœºï¼Œå¿…ä¸å¯å°‘çš„é…ç½®æœ‰å“ªäº›ã€‚å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨åˆ«çš„è™šæ‹ŸåŒ–äº§å“æ—¶ä¹Ÿå¯ä»¥å¸®åŠ©è¾¾åˆ°ä¸¾ä¸€åä¸‰çš„æ•ˆæžœã€‚

è€Œæœ¬æ–‡æè¿°çš„å…·ä½“æ‰‹æ®µï¼Œä»…é€‚ç”¨äºŽå­¦ä¹ å’ŒåŸºäºŽæ­¤åšä¸€äº›å®žéªŒã€‚ä¸å»ºè®®åœ¨ç”Ÿäº§ç›´æŽ¥ç”¨è¿™ä¸ªæ–¹æ¡ˆã€‚ç”Ÿäº§ä¸Šå»ºè®®çš„æ–¹æ¡ˆæ˜¯ï¼ŒåŸºäºŽ `libvirtd` æœåŠ¡ï¼Œè¿œç¨‹åœ°å¼€å¯ã€ç®¡ç†ã€ç›‘è§†ä¸€äº›åŸºäºŽ QEMU/KVM çš„è™šæœºã€‚

â€”â€”å¯å‚è€ƒè¿™ä¸ªï¼š https://doc.opensuse.org/documentation/leap/archive/15.2/virtualization/single-html/book-virt/index.html




# é™„å½•

## about Libvirt .sth

è¿™é‡Œæ˜¯ä¸€äº›å…³äºŽ Libvirt ä½¿ç”¨çš„è®°å½•ã€‚

_æœ‰å¯èƒ½éœ€è¦æŒ‚è½½åˆ°ä¸€ä¸ªå•ç‹¬çš„æ•°æ®ç›˜ï¼Œè¿™ä¸ªæ•°æ®ç›˜å°±ä¼šå……å½“æ‰€æœ‰è™šæœºçš„ç³»ç»Ÿç›˜ã€‚å¦‚æžœæƒ³è¦é¿å…æ•°æ®ç«žäº‰ï¼Œå¯èƒ½éœ€è¦è®©ä¸åŒçš„ç£ç›˜é•œåƒæ–‡ä»¶å®žé™…å­˜åœ¨äºŽä¸åŒçš„ç‰©ç†æ•°æ®ç›˜ä¸­ã€‚è¿˜å¯ä»¥å¯¹è™šæœºä¹ŸæŒ‚è½½çœŸå®žçš„æ•°æ®ç›˜ä½œä¸ºå…¶æ•°æ®ç›˜ä½¿ç”¨ã€‚_

### é€šè¿‡ `virt-manager` ä½¿ç”¨ Libvirt æ—¶çš„ Troubleshooting 

_ä»¥ä¸‹ç¤ºä¾‹æ¥è‡ª openSUSE Leap 15.2 æ“ä½œç³»ç»Ÿ_

_é»˜è®¤æ‚¨å·²ç»è‡³å°‘æ‰§è¡Œè¿‡ä¸€æ¬¡ `sudo systemctl restart libvirtd` å‘½ä»¤_

#### é”™è¯¯ `no polkit agent available`

å®Œæ•´é”™è¯¯ï¼š

~~~~
Unable to connect to libvirt qemu:///system.

authentication unavailable: no polkit agent available to authenticate action 'org.libvirt.unix.manage'

~~~~

##### ç¤ºä¾‹

![0b0d58c66a1a8f06e9d83cc44558b5f7.png](vbox-bridge.imgs/0b0d58c66a1a8f06e9d83cc44558b5f7.png)

##### è§£å†³

å‚è€ƒ [Authorization with PolKit | Security and Hardening Guide | openSUSE Leap 15.2](https://doc.opensuse.org/documentation/leap/archive/15.2/security/html/book-security/cha-security-policykit.html) ä¸­çš„ï¼š

> ### 19.1.2  PolKit çš„ç»“æž„
> 
> PolKit çš„é…ç½®å–å†³äºŽ _è¡ŒåŠ¨_ å’Œ _æŽˆæƒè§„åˆ™_ ï¼š
> 
> åŠ¨ä½œï¼ˆæ–‡ä»¶æ‰©å±•å `*.policy` ï¼‰
> 
> å†™ä¸º XML æ–‡ä»¶å¹¶ä½äºŽ `/usr/share/polkit-1/actions` ã€‚æ¯ä¸ªæ–‡ä»¶å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªåŠ¨ä½œï¼ˆ action ï¼‰ï¼Œæ¯ä¸ªåŠ¨ä½œéƒ½åŒ…å«è¯´æ˜Žå’Œé»˜è®¤æƒé™ã€‚å°½ç®¡ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥ç¼–å†™è‡ªå·±çš„è§„åˆ™ï¼Œä½†ä¸å¾—ç¼–è¾‘ PolKit çš„æ–‡ä»¶ã€‚
> 
> æŽˆæƒè§„åˆ™ï¼ˆæ–‡ä»¶æ‰©å±•å `*.rules` )
> 
> ç¼–å†™ä¸º JavaScript æ–‡ä»¶ï¼Œä½äºŽä¸¤ä¸ªä½ç½®ï¼š `/usr/share/polkit-1/rules.d` ç”¨äºŽç¬¬ä¸‰æ–¹åŒ…ï¼ˆ third party packages ï¼‰ã€ `/etc/polkit-1/rules.d` ç”¨äºŽæœ¬åœ°é…ç½®ï¼ˆ local configurations ï¼‰ã€‚æ¯ä¸ªè§„åˆ™æ–‡ä»¶éƒ½å¼•ç”¨åŠ¨ä½œï¼ˆ action ï¼‰æ–‡ä»¶ä¸­æŒ‡å®šçš„æ“ä½œã€‚è§„åˆ™ç¡®å®šå…è®¸å¯¹ç”¨æˆ·å­é›†è¿›è¡Œå“ªäº›é™åˆ¶ã€‚ä¾‹å¦‚ï¼Œè§„åˆ™æ–‡ä»¶å¯èƒ½ä¼šå¦å†³é™åˆ¶æ€§æƒé™å¹¶å…è®¸æŸäº›ç”¨æˆ·å…è®¸è¯¥æƒé™ã€‚
> 

ä»¥åŠï¼š

> ### 19.4.2  æ·»åŠ æŽˆæƒè§„åˆ™
> 
> æ‚¨è‡ªå·±çš„æŽˆæƒè§„åˆ™å°†è¦†ç›–é»˜è®¤è®¾ç½®ã€‚è¦æ·»åŠ æ‚¨è‡ªå·±çš„è®¾ç½®ï¼Œè¯·å°†æ–‡ä»¶å­˜å‚¨åœ¨ `/etc/polkit-1/rules.d/` ã€‚
> 
> æ­¤ç›®å½•ä¸­çš„æ–‡ä»¶ä»¥ä¸¤ä½æ•°å­—å¼€å¤´ï¼ŒåŽè·Ÿæè¿°æ€§åç§°ï¼Œå¹¶ä»¥ `.rules` ç»“å°¾ã€‚è¿™äº›æ–‡ä»¶ä¸­çš„å‡½æ•°æŒ‰å…¶æŽ’åºé¡ºåºæ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œ `00-foo.rules` æŽ’åºï¼ˆå¹¶å› æ­¤æ‰§è¡Œï¼‰åœ¨ `60-bar.rules` ä¹‹å‰ã€ç”šè‡³æ˜¯åœ¨ `90-default-privs.rules` ä¹‹å‰ã€‚
> 
> åœ¨æ–‡ä»¶å†…éƒ¨ï¼Œè„šæœ¬å°†æ£€æŸ¥åœ¨ `.policy` æ–‡ä»¶ä¸­å®šä¹‰çš„æŒ‡å®šåŠ¨ä½œ ID ï¼ˆ action ID ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœè¦å…è®¸ `gparted` å‘½ä»¤ç”± `admin` ç»„çš„ä»»ä½•æˆå‘˜æ‰§è¡Œï¼Œè¯·æ£€æŸ¥åŠ¨ä½œ ID `org.opensuse.policykit.gparted` ï¼š
> 
> ~~~~ javascript
> /* Allow users in admin group to run GParted without authentication */
> polkit.addRule(function(action, subject) {
>     if (action.id == "org.opensuse.policykit.gparted" &&
>         subject.isInGroup("admin")) {
>         return polkit.Result.YES;
>     }
> });
> ~~~~
> 
> æƒ³è¦åœ¨ PolKit API ä¸­æ‰¾åˆ°å‡½æ•°çš„æ‰€æœ‰ç±»å’Œæ–¹æ³•çš„æè¿°ï¼Œè¯·è®¿é—®[http://www.freedesktop.org/software/polkit/docs/latest/ref-api.html](http://www.freedesktop.org/software/polkit/docs/latest/ref-api.html).
> 

ç”±ä¸Šè¿°å¯çŸ¥ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸€ä¸ªç‰¹åˆ«çš„ç”¨æˆ·ç»„å¢žåŠ å¯¹äºŽ `org.libvirt.unix.manage` è¿™ä¸ªåŠ¨ä½œï¼ˆ action ï¼‰çš„å…è®¸ä½¿ç”¨çš„è§„åˆ™ã€‚

å’Œåˆ«çš„ä¸€äº›ç³»ç»Ÿé‡Œç”¨ `.pkla` æ‰©å±•åçš„ç±»ä¼¼ INI æ ¼å¼çš„è¯­æ³•ä¸ä¸€æ ·ï¼Œè¿™é‡Œçš„ `.rules` æ‰©å±•åä½¿ç”¨ `javascript` è¯­æ³•ã€‚ï¼ˆæˆ‘æ²¡ç ”ç©¶è¿‡ä¼šè¿™æ ·çš„ç†ç”±ã€‚å¯èƒ½ PolKit æ˜¯ç‰ˆæœ¬ä¸åŒï¼Ÿæˆ–è€… `js` æ¯”å•çº¯çš„é…ç½®æ–‡ä»¶æ›´çµæ´»ï¼Ÿï¼‰

è¿™é‡ŒæŠŠç”¨æˆ·ç»„ç†è§£ä¸ºåªæ˜¯ç”¨æˆ·èº«ä¸Šçš„æ ‡ç­¾è€Œå·²å°±å¥½ã€‚

æ ¹æ®ä¸Šè¿°è¯´æ˜Žï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æˆ‘ä»¬å½“å‰ç”¨æˆ·çš„æŸä¸ª _ç”¨æˆ·ç»„_ ï¼Œå¢žåŠ ä¸€ä¸ªå¯¹ `org.libvirt.unix.manage` åŠ¨ä½œçš„é€šè¡Œè§„åˆ™ã€‚

é¦–å…ˆï¼Œä¸º `admin` ç”¨æˆ·å¢žåŠ ç”¨æˆ·ç»„ `libvirt` ã€‚ä¸å‡ºæ„å¤–ï¼Œè¿™ä¸ªç”¨æˆ·ç»„åº”å½“æ˜¯å·²ç»è¢«è‡ªåŠ¨åˆ›å»ºå¥½äº†çš„ã€‚

ç„¶åŽï¼Œæˆ‘ä»¬è¦æŠŠå†…å®¹å¦‚ä¸‹çš„ `js` è„šæœ¬å†™å…¥ `/etc/polkit-1/rules.d/00-libvirt-group_libvirt.rules` æ–‡ä»¶ï¼š

~~~~ javascript
/* Allow users in libvirt group to run org.libvirt.unix.manage without authentication */

polkit.addRule(
    
    function(action, subject)
    {
        if (
            action.id == "org.libvirt.unix.manage" &&
            subject.isInGroup("libvirt") )
        { return polkit.Result.YES ; }
    } ) ; 
~~~~

ä¸Šè¿°æ“ä½œçš„ä»£ç ï¼š

~~~~ bash

: define fun &&

pk_libvirt__ ()
{
    groupadd libvirt ;
    usermod --append --groups libvirt -- "${1:-admin}" ;
    
    echo '

/* Allow users in libvirt group to run org.libvirt.unix.manage without authentication */

polkit.addRule(
    
    function(action, subject)
    {
        if (
            action.id == "org.libvirt.unix.manage" &&
            subject.isInGroup("libvirt") )
        { return polkit.Result.YES ; }
    } ) ; ' | tee -- /etc/polkit-1/rules.d/00-libvirt-group_libvirt.rules ;
} &&

: usage &&

snapper create -d 'libvirt group add & polkit' --command "$(declare -f pk_libvirt__) ; pk_libvirt__ admin"

~~~~

ä¸Šè¿°ç¤ºä¾‹ï¼Œèƒ½åœ¨è¿™ä¸€æ•´å¥—æ“ä½œä¹‹å‰ä¿å­˜ç³»ç»Ÿå¿«ç…§ã€å¹¶åœ¨æ“ä½œåŽå†ä¿å­˜ä¸€ä¸ªã€‚

![e37726df607f46391885644d4e6328f8.png](vbox-bridge.imgs/e37726df607f46391885644d4e6328f8.png)


è¿™æ—¶å€™å†é‡æ–°åŒå‡»è“æ¡éƒ¨åˆ†å°è¯•è¿žæŽ¥ï¼Œå°±èƒ½è¿žæŽ¥æˆåŠŸäº†ï¼š

![a9603a52fa98d02316acaf1fcd599769.png](vbox-bridge.imgs/a9603a52fa98d02316acaf1fcd599769.png)

ç‚¹æ–°å»ºè™šæœºçš„æŒ‰é’®ä»¥éªŒè¯ï¼Œåƒä¸‹å›¾è¿™æ ·å°±è¯´æ˜Žè¿™ä¸ªè¡ŒåŠ¨çš„æƒé™çš„é—®é¢˜å°±è§£å†³äº†ï¼š

![760264cfc1a4cc7636978e628c7769e9.png](vbox-bridge.imgs/760264cfc1a4cc7636978e628c7769e9.png)

ç½‘ç»œå’Œè™šæœºç³»ç»Ÿç›˜çš„é…ç½®å¯ä»¥ä»Žæ­£æ–‡é‡Œçš„å†…å®¹ä¸­ä¸¾ä¸€åä¸‰ã€‚

åœ¨å®‰è£…ä»‹è´¨å†…çš„æ“ä½œå’ŒåŽŸæ¥ä¸€æ ·ã€‚

å¦å¤–ï¼Œç”±äºŽè¿™ä¸ªç•Œé¢å’ŒçœŸæ­£æ‰¿æ‹…è™šæ‹Ÿæœºæ“ä½œçš„ `libvirtd` å®ˆæŠ¤æœåŠ¡ï¼Œè™šæ‹Ÿæœºè¿›ç¨‹å¹¶ä¸æ˜¯ä½ æ‰“å¼€çš„ç•Œé¢æˆ–è€…æ¡Œé¢çš„å­è¿›ç¨‹ï¼Œç”šè‡³ä½ è¿˜å¯ä»¥åœ¨åˆ«çš„èŠ‚ç‚¹ç”¨ `virt-manager` ç®¡ç†è¿™ä¸ªèŠ‚ç‚¹çš„è™šæ‹Ÿæœºï¼Œæ‰€ä»¥è¯´ä¸å­˜åœ¨ã€å…³æŽ‰è¿™ä¸ª VNCServer ä¼šä¸ä¼šæŠŠè™šæ‹Ÿæœºä¹Ÿå…³æŽ‰ã€‘çš„æ‹…å¿ƒã€‚

ç±»æ¯”åˆ° virtualbox çš„è¯ï¼Œè¿™ä¸ªå°±æ˜¯åªæœ‰â€œåˆ†ç¦»å¼å¯åŠ¨â€ã€‚

##### æ›´å¤šçš„å…¼å®¹æ€§

è¿™æ˜¯ç¤ºä¾‹ä¸­ä½¿ç”¨çš„ç‰ˆæœ¬ä¸å¿…è€ƒè™‘çš„äº‹æƒ…ã€‚

è¿™ä¸ªå¯ä»¥åœ¨ `/etc/libvirt/libvirtd.conf` é‡Œçœ‹åˆ°ï¼š

![16b7841190e0f48602ade08a4832df3b.png](vbox-bridge.imgs/16b7841190e0f48602ade08a4832df3b.png)

å› æ­¤æœ‰äº†ä»¥ä¸‹çš„å¤æ‚äº†ä¸€ç‚¹çš„å®šä¹‰ï¼š

~~~~ bash

: see: 
: : https://doc.opensuse.org/documentation/leap/archive/15.2/security/html/book-security/cha-security-policykit.html
: : https://blog.xiaoben.li/p/497
: : https://www.vvave.net/archives/debian-connect-virt-manager-via-ssh-report-error.html

: def
polkit_libvirt_user__ ()
{
    local libvirtd_socks_conf="$(
        awk -F'#' -- /unix_sock_group/'{print$2}' /etc/libvirt/libvirtd.conf )" &&
    
    local libvirt_group="$(
        eval "echo $(echo "$libvirtd_socks_conf" | cut -d= -f2 )" )" &&
    
    : || { return $? ; } ;
    
    : å¦‚æžœèŽ·å–æ—¶å¤±è´¥å°±ç®—å¤±è´¥ ;
    
    
    test -n $libvirt_group ||
    { 1>&2 echo get prop "'"unix_sock_group"'" failed from /etc/libvirt/libvirtd.conf ; return 2 ; } ;
    
    : å¦‚æžœå˜é‡é‡Œæ²¡æœ‰å†…å®¹ä¹Ÿç®—å¤±è´¥ ;
    
    
    
    groupadd "$libvirt_group" ;
    usermod --append --groups "$libvirt_group" -- "${1:-admin}" ;
    
    :;
    
    (
        echo ; echo '###############' ; echo ;
        echo "$libvirtd_socks_conf" ) | tee -a -- /etc/libvirt/libvirtd.conf ;
    
    :;
    
    
    echo '

/* Allow users in '"$libvirt_group"' group to run org.libvirt.unix.manage without authentication */

polkit.addRule(
    
    function(action, subject)
    {
        if (
            action.id == "org.libvirt.unix.manage" &&
            subject.isInGroup("'"$libvirt_group"'") )
        { return polkit.Result.YES ; }
    } ) ; ' | tee -- /etc/polkit-1/rules.d/00-libvirt-group_libvirt.rules ;
    
    :;
} ;

sudo systemctl restart libvirtd ;

: use:
snapper create -d 'libvirt group add & polkit' --command "$(declare -f polkit_libvirt_user__) ; polkit_libvirt_user__ admin"

~~~~

å®ƒå’Œä¸Šé¢çš„ã€è§£å†³ã€‘ç¤ºä¾‹ä¸­çš„åŒºåˆ«ä»…ä»…åœ¨äºŽï¼š `libvirt` è¿™ä¸ªç”¨æˆ·ç»„çš„ä¿¡æ¯æ˜¯åŠ¨æ€ä»Ž `/etc/libvirt/libvirtd.conf` å†…èŽ·å–ï¼Œä¸”ä¼šå¾€è¯¥æ–‡ä»¶å†…å¢žåŠ è¡Œ `unix_sock_group = "libvirt"` ï¼Œä»…æ­¤è€Œå·²ã€‚



### å­˜å‚¨ä½¿ç”¨

åœ¨ç®¡ç†å­˜å‚¨å·çš„ç•Œé¢ï¼š

![7a40ce92ac5fff61c314565efd865494.png](vbox-bridge.imgs/7a40ce92ac5fff61c314565efd865494.png)

ç‚¹å‡»æ©™è‰²æ¡†æŒ‰é’®ã€æ·»åŠ æ± ã€‘å¯ä»¥å¢žåŠ æ–°çš„å­˜å‚¨æ± ã€‚

å­˜å‚¨æ± å°±æ˜¯ä¸ªç›®å½•ã€‚ç„¶åŽä½ å¯ä»¥æŠŠå®ƒæŒ‚è½½åˆ°æŸä¸ªæ•°æ®ç›˜ä¸Šï¼Œè­¬å¦‚ï¼ŒåƒæŒ‚è½½ `/var/lib/docker` é‚£æ ·ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠæ•´ä¸ª `/var/lib/libvirt/images` ç›®å½•æŒ‚è½½å‡ºåŽ»ï¼Œå› ä¸ºè¿™é‡Œé¢å…¨æ˜¯ç”¨æˆ·æ•°æ®ã€‚

ä¸€ä¸ªè¿™é‡Œçš„å·å°±æ˜¯ä¸€ä¸ª `.qcow2` æ–‡ä»¶ã€‚ä¸€èˆ¬ï¼Œåœ¨åˆ›å»ºè™šæ‹Ÿæœºçš„å¼•å¯¼è¿‡ç¨‹ä¸­ï¼Œç»è¿‡é»˜è®¤è®¾ç½®åˆ›å»ºçš„å·ï¼Œå°±æ˜¯è™šæ‹Ÿæœºçš„ç³»ç»Ÿå·ï¼ˆç³»ç»Ÿç›˜ï¼‰ã€‚

åœ¨æ± ä¸­å¯åˆ›å»ºå­˜å‚¨å·ã€‚å¯ä»¥ç†è§£ä¸ºè™šæ‹Ÿå­˜å‚¨ç›˜ã€‚å¤§å°å’Œåç§°åœ¨åˆ›å»ºæ—¶è®¾å®šã€‚

![8008f6929182d7deb25c206ceee02596.png](vbox-bridge.imgs/8008f6929182d7deb25c206ceee02596.png)

å¦‚æžœä½ åœ¨åˆ›å»ºè™šæ‹Ÿæœºæ—¶æ¥åˆ°è¿™ä¸ªç•Œé¢ï¼Œåˆ›å»ºæ–°å·çš„åç§°ä¼šæ™ºèƒ½åœ°ä¸Žä½ é€‰å¥½çš„ç³»ç»Ÿå®‰è£…ç›˜ç›¸åŒ¹é…ã€‚

ç‚¹ä¸‹å›¾çš„ã€ç®¡ç†ã€‘å³å¯åœ¨åˆ›å»ºè™šæ‹Ÿæœºæ˜¯æ¥åˆ°è¯¥ç•Œé¢ã€‚


![9946ea65292c0e7bad790235d329c9a3.png](vbox-bridge.imgs/9946ea65292c0e7bad790235d329c9a3.png)

å¦‚æ­¤ï¼Œåªè¦ç¡®ä¿ç‰¹å®šçš„ `pool` ç›®å½•æ˜¯è¢«æŒ‚è½½åˆ°æ•°æ®ç›˜çš„ï¼Œå°±èƒ½ç¡®ä¿è™šæ‹Ÿæœºåœ¨å¯¹åº”çš„æ•°æ®ç›˜ä¸Šã€‚




### å®‰è£…å‰é€‰é¡¹

#### è‡ªåŠ¨å®‰è£…

è¿™ä¸ªåœ°æ–¹å¿…é¡»å¾—åˆ°å‹¾é€‰ï¼Œæ‰ä¼šè¿›å…¥æ­£å¸¸çš„è£…æœºç•Œé¢ã€‚

![dbe1d5af5f3c8ffb1011886f9cc1cca2.png](vbox-bridge.imgs/dbe1d5af5f3c8ffb1011886f9cc1cca2.png)

#### UEFI

è¿™ä¸ªéœ€è¦å®‰è£…è½¯ä»¶åŒ… `qemu-ovmf-x86_64` æˆ–è€… `qemu-uefi-aarch64` ã€‚

æ ¹æ®ä½ ä½¿ç”¨çš„ç³»ç»Ÿæ˜¯å“ªç§æž¶æž„ï¼Œé€‰ä¸€ä¸ªå®‰è£…ã€‚

å‚è€ƒï¼š [Installation of Virtualization Components | Virtualization Guide | openSUSE Leap 15.2](https://doc.opensuse.org/documentation/leap/archive/15.2/virtualization/html/book-virt/cha-vt-installation.html#sec-vt-installation-ovmf) ã€‚

ä½¿ç”¨ï¼š

![7506c5779b912b482f256b0561c9e9a3.png](vbox-bridge.imgs/7506c5779b912b482f256b0561c9e9a3.png)

åœ¨ä¸Šå›¾çš„ã€Firmwareã€‘å³è¾¹ï¼ŒåŽŸæœ¬æ˜¯ BIOS ï¼Œä¸‹æ‹‰é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ UEFI å­—æ ·ï¼Œå³å¯ï¼š

![c98fb19dd9293131b99b9db01c8c6fc1.png](vbox-bridge.imgs/c98fb19dd9293131b99b9db01c8c6fc1.png)

ï¼ˆè¿™é‡Œä¸åŒçš„ UEFI ä¸»è¦åŒºåˆ«åº”è¯¥æ˜¯å†…å«è¯ä¹¦ä¸åŒã€‚ï¼‰

å¦‚æžœä»¥ UEFI æ¨¡å¼å¯åŠ¨ï¼Œæœ‰å¯èƒ½ä¼šæœ‰è¿™æ ·çš„ç”»é¢ï¼š

![95c167705a5a0c7af89dd8f3f6b19f38.png](vbox-bridge.imgs/95c167705a5a0c7af89dd8f3f6b19f38.png)

å¤§æ„æ˜¯è¯´ï¼Œå®‰è£…ç›˜é‡Œè‡ªå·±å¸¦äº†ä¸ªè¯ä¹¦ï¼Œè¦ä¸è¦ä¿¡ä»»ã€‚æƒ³ç»§ç»­ï¼Œå°±ä¿¡ä»»ï¼Œæˆ–è€…ï¼Œæ£€æŸ¥ä½ ä¸‹è½½çš„å®‰è£…ç›˜çš„å“ˆå¸Œæ ¡éªŒç æ˜¯å¦ç¬¦åˆä¸‹è½½å¤„æä¾›çš„é‚£ä¸ªã€‚

è¿™ä¸ª UEFI çš„å¯åŠ¨ç”»é¢æ˜¯è¿™æ ·çš„ï¼š

![72b19e914c6beb0a58935cc5b94a64a5.png](vbox-bridge.imgs/72b19e914c6beb0a58935cc5b94a64a5.png)

å¦‚æžœæ˜¯çœŸå®žçš„ç”µè„‘ï¼Œé‡Œé¢é‚£ä¸ª TianoCore çš„æ ‡å¿—å°±ä¼šæ˜¯å¯¹åº”ç”µè„‘å“ç‰Œçš„æ ‡å¿—ã€‚

UEFI ç›®å‰åœ¨ QEMU ä¸Šçš„æ”¯æŒæœ‰ä¸€ç‚¹å°ç‘•ç–µï¼Œé‚£å°±æ˜¯å…¶é»˜è®¤é…ç½®ä¸æ”¯æŒå¿«ç…§å»ºç«‹ï¼š

![56da3ac837ea03fea6ff2cd473fe9783.png](vbox-bridge.imgs/56da3ac837ea03fea6ff2cd473fe9783.png)

é»˜è®¤é…ç½®å°±æ˜¯è¿™ä¸ªï¼š

![493e09829f1c1dcbc81fe9df1f6a817c.png](vbox-bridge.imgs/493e09829f1c1dcbc81fe9df1f6a817c.png)

è¿™é‡Œçš„ `pflash` éœ€è¦æ”¹æˆ `rom` ã€‚

![e45d0f70e46e948541ecd6ee98c082f7.png](vbox-bridge.imgs/e45d0f70e46e948541ecd6ee98c082f7.png "e45d0f70e46e948541ecd6ee98c082f7.png")

![00122acd0e1715c8bfa5d104bdcd17bf.png](vbox-bridge.imgs/00122acd0e1715c8bfa5d104bdcd17bf.png)

å…ˆåˆ—å‡ºï¼Œç„¶åŽåœ¨å¿«ç…§ä¸‹å¯¹ç‰¹å®šè™šæ‹Ÿæœºé…ç½®ç¼–è¾‘ã€‚

è¿™å…¶å®žå°±æ˜¯ï¼Œåœ¨æ‰§è¡Œ `virsh edit opensuse-3` ä¹‹å‰å…ˆåˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆå®ƒåœ¨ä¸‹æ–‡å°±æ˜¯ `36` å·ï¼‰ï¼Œç„¶åŽåœ¨å‘½ä»¤æ‰§è¡Œç»“æŸï¼ˆä¹Ÿå°±æ˜¯æˆ‘æ”¹å®Œäº†åŽä¿å­˜é€€å‡ºï¼‰æ—¶å†åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼ˆå®ƒåœ¨ä¸‹æ–‡å°±æ˜¯ `37` å·ï¼‰ï¼Œå¹¶ç»™ä»–ä»¬å¸¦ä¸Šæ³¨é‡Šã€‚

ä¸Šé¢çš„å‘½ä»¤å›žè½¦ï¼Œå°±å¯ä»¥ç¼–è¾‘äº†ã€‚è¿™ä¸ªç•Œé¢çš„æ“ä½œæ–¹å¼å’Œ `vi` å‘½ä»¤ä¸€æ ·ã€‚

![48dd192e341e4f248416e95ac4887ed9.png](vbox-bridge.imgs/48dd192e341e4f248416e95ac4887ed9.png)

åªæ”¹è¿™ä¸€ä¸ªåœ°æ–¹ï¼š

![e45d0f70e46e948541ecd6ee98c082f7.png](vbox-bridge.imgs/e45d0f70e46e948541ecd6ee98c082f7.png)

æ”¹å®ŒåŽä¿å­˜é€€å‡ºã€‚

![7fd788b75724e5062d2f28591fd23027.png](vbox-bridge.imgs/7fd788b75724e5062d2f28591fd23027.png)

ä»Žè€Œï¼Œå€ŸåŠ©å·¥å…· `snapper` å¯ä»¥çœ‹åˆ°ï¼Œå®žé™…è¢«æ›´æ”¹çš„æ˜¯è¿™ä¸ªæ–‡ä»¶ï¼š

![c48e2a1aa7e252d775e671229af07888.png](vbox-bridge.imgs/c48e2a1aa7e252d775e671229af07888.png)

å¯ä»¥çœ‹åˆ°è¿™ä¸ªç•Œé¢ä¹Ÿå®žæ—¶å‘ç”Ÿäº†æ”¹å˜ï¼š

![a28eb5aa6b039eeef4be3c0281412dee.png](vbox-bridge.imgs/a28eb5aa6b039eeef4be3c0281412dee.png)

å†ä¿å­˜å¿«ç…§ï¼Œåº”è¯¥å°±ä¸ä¼šæŠ¥é”™äº†ï¼š

![6886c90aaa81ea603b60a44a7b9c0cf7.png](vbox-bridge.imgs/6886c90aaa81ea603b60a44a7b9c0cf7.png)

å¦‚å›¾ï¼Œå¿«ç…§åˆ›å»ºæˆåŠŸã€‚

ä½†æ˜¯ï¼Œè¿™ä¸ªé…ç½®ä¸‹ï¼Œä¸èƒ½å¼€æœºï¼š

![e139b61bc833983affc6f88045d95843.png](vbox-bridge.imgs/e139b61bc833983affc6f88045d95843.png)

è¦æƒ³å¼€æœºï¼Œè¿™ä¸ªé…ç½®è¿˜å¾—æ”¹å›žåŽ»â€¦â€¦æ‰€ä»¥ï¼Œ `pflash` æ”¹ä¸º `rom` çš„æ–¹æ¡ˆä»ç„¶å¹¶ä¸æ–¹ä¾¿ã€‚

æ‰€ä»¥ï¼Œå¯¹äºŽæƒ³è¦ä¿å­˜å¿«ç…§çš„æœºå™¨ï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤çš„ BIOS å¯åŠ¨ã€‚




### ç•Œé¢ä½¿ç”¨

#### å…¨å±

è¿™ä¸ªæ˜¯è¿›å…¥å…¨å±ï¼š

![058840feb18d7ba953e73b0309997c50.png](vbox-bridge.imgs/058840feb18d7ba953e73b0309997c50.png)

è¿™ä¸ªæ˜¯ç¦»å¼€å…¨å±ï¼ˆéœ€è¦é¼ æ ‡æŒ‡åœ¨æœ€ä¸Šé¢ä¸­é—´ï¼‰ï¼š

![8e059241f47a71d47e1fbdf0bce32f03.png](vbox-bridge.imgs/8e059241f47a71d47e1fbdf0bce32f03.png)



#### è„±ç¦»æŽ§åˆ¶å°

![95c167705a5a0c7af89dd8f3f6b19f38.png](vbox-bridge.imgs/95c167705a5a0c7af89dd8f3f6b19f38.png)

çœ‹æœ€é¡¶ä¸Šçš„æç¤ºã€‚

å¦å¤–ï¼Œä¸åŒäºŽ virtualbox ï¼Œåœ¨è¿™é‡Œçš„é¼ æ ‡è„±ç¦»ä¸€èˆ¬éƒ½èƒ½è‡ªåŠ¨å®Œæˆã€‚










## about openSUSE Leap 15.2 .sth

ç”±äºŽç¤ºä¾‹æ˜¯åœ¨ GNU/Linux å‘è¡Œç‰ˆ openSUSE Leap 15.2 ä¸­è¿›è¡Œçš„ï¼Œå› æ­¤ä¸‹é¢é™„å¸¦ä¸€äº›å…³äºŽè¿™ä¸ªç³»ç»Ÿçš„å¿…è¦ä¿¡æ¯ã€‚

å®‰è£…ä¸­è¦æ³¨æ„çš„ä¸œè¥¿å’Œä¸€äº›å·¥å…·çš„ç®€å•ä½¿ç”¨è¯´æ˜Žåœ¨è¿™é‡Œè®°å½•ã€‚






### Install

ç³»ç»Ÿå®‰è£…åŸºäºŽ `virt-manager` æä¾›çš„è™šæ‹ŸåŒ–ç•Œé¢æ¼”ç¤ºã€‚

åªè¯´å‡ ä¸ªæˆ‘è®¤ä¸ºæ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†ã€‚

#### ç•Œé¢

##### ç•Œé¢æ‹“æ‰‘

å’Œ CentOS 7 ç³»åˆ—ä¸åŒï¼Œè¿™ä¸ªå‘è¡Œç‰ˆçš„å®‰è£…ç•Œé¢çš„åˆ‡æ¢å…³ç³»æ˜¯çº¿æ€§è€Œä¸æ˜¯æ ‘çŠ¶çš„ã€‚ä½ åªæœ‰ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œè€Œä¸èƒ½å¤Ÿï¼ˆæˆ–è€…ä¸å¤ªæ–¹ä¾¿ï¼‰ä»¥éšæ„çš„é¡ºåºé…ç½®ä¸åŒçš„éƒ¨åˆ†ã€‚

å½“ç„¶ï¼Œæœ€ç»ˆä¼šæœ‰ä¸ªæ±‡æ€»ï¼Œä½†é‡Œé¢å¹¶ä¸åŒ…æ‹¬æ‰€æœ‰éƒ¨åˆ†ã€‚

##### éšè—çš„æƒ…å†µ

æœ‰äº›ç•Œé¢æ˜¯ä¸ä¸€å®šå‡ºçŽ°ã€ä¸”ä¸ä¼šå‘Šè¯‰ä½ å®ƒæ²¡æœ‰å‡ºçŽ°çš„ã€‚

æ¯”å¦‚ï¼Œæˆ‘ç›®å‰çŸ¥é“çš„æœ‰ï¼š

- åªæœ‰åœ¨ç½‘ç»œä¸é€šæ—¶ï¼Œæ‰ä¼šå‡ºçŽ°æ‰‹åŠ¨ç½‘ç»œé…ç½®çš„ç•Œé¢ï¼Œå¦åˆ™è‡ªåŠ¨é…ç½®æˆåŠŸä¸”å‡ ä¹Žæ•´ä¸ªè¿‡ç¨‹ä¸­ä¸ä¼šå†è¦ä½ ä¿®æ”¹ã€‚
- åªæœ‰ç½‘ç»œé€šç•…æ—¶ï¼Œæ‰ä¼šåœ¨åˆšåˆšå®Œæˆè¯­è¨€é€‰æ‹©çš„æ—¶å€™ï¼Œå¼¹å‡ºã€æ˜¯å¦æ·»åŠ ç½‘ç»œè½¯ä»¶æºã€‘çš„è¯¢é—®ï¼Œå¦åˆ™ä¸ä¼šå‡ºçŽ°è¿™ä¸ªè¯¢é—®ã€‚

å½“ç„¶ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œè¿™äº›ä¹Ÿæ— ä¼¤å¤§é›…ã€‚

#### å®‰è£…æ—¶çš„ç½‘ç»œï¼ˆä»¥åŠå®‰è£…æ­¥éª¤ï¼‰

å¯¹äºŽæœ‰ DHCP ç­‰è‡ªåŠ¨ç½‘å…³çš„ç½‘ç»œçŽ¯å¢ƒï¼Œè¿™ä¸ªå®‰è£…å™¨æœ‰èƒ½åŠ›è‡ªåŠ¨å‘çŽ°å¹¶è‡ªåŠ¨å®Œæˆé…ç½®ã€‚

æ‰€ä»¥æ­¤å¤„åªæ¼”ç¤ºæ‰‹åŠ¨é…ç½®çš„æƒ…å†µã€‚

ä¸ºæ­¤ï¼Œæ–°å»ºè™šæ‹Ÿæœºæ—¶ï¼Œæˆ‘è¦è¿™æ ·é€‰æ‹©ï¼š

![57eaeb6d013ae5605e1c159cadb13c82.png](vbox-bridge.imgs/57eaeb6d013ae5605e1c159cadb13c82.png)

å› ä¸ºæˆ‘ç”¨çš„è£¸æœºçš„æ‰€åœ¨ç½‘ç»œå°±æ˜¯ä¸æ”¯æŒ DHCP çš„ï¼Œæ˜¯ä¸€ä¸ªéœ€è¦æ‰‹åŠ¨åˆ†é… IP çš„ç®€å•çš„ç½‘ç»œã€‚

##### æ³¨æ„

å»ºè®®å…ˆåˆ«æŠŠç½‘é…é€šã€‚å› ä¸ºä¸€æ—¦æºè¢«é…é€šè¿‡ä¸€æ¬¡ï¼Œå†å›žæ¥æŠŠç½‘æ”¹æˆä¸åŒçš„ï¼Œå†ç‚¹ç»§ç»­çš„è¯ï¼Œæƒ³å›žå°±å›žä¸æ¥äº†â€”â€”å¼¹çª—â€œæºåŒæ­¥å¤±è´¥â€çš„å…³é—­åªä¼šè®©é¡µé¢è¿›å…¥ä¸‹ä¸€æ­¥ä»Žè€Œæ— æ³•é€€å›žä¸Šä¸€æ­¥ã€‚

##### å…ˆä½œä¸é…ç½‘çš„é…ç½®

è¿™ä¸ªé¡µé¢åœ¨è‡ªåŠ¨é…ç½‘ä¸æˆåŠŸçš„æ—¶å€™ä¼šç»™ä½ æ˜¾ç¤ºå‡ºæ¥ï¼š

![673e1f33b9e49a90c333784e5c638c0b.png](vbox-bridge.imgs/673e1f33b9e49a90c333784e5c638c0b.png)

æ‰€ä»¥è¿™é‡Œåªé…ç½®ä¸­é—´çš„ã€ Hostname/DNS ã€‘ï¼š

åœ¨è¿™é‡Œé…ç½® Hostname ï¼š

![56e4d4512d133d8114c6ef2e6e7cc63b.png](vbox-bridge.imgs/56e4d4512d133d8114c6ef2e6e7cc63b.png)

ä¸‹é¢çš„ DHCP é€‰æˆ no å°±èƒ½å›ºå®šæœ¬æœºçš„ Hostname ã€‚

è¿™ä¸ªä½ç½®ä¸è¦åŠ¨ï¼Œåªæ˜¯åœ¨ä¸‹é¢å¡«ä¸Šä½ è¦ç»™é…çš„ DNS å°±å¥½ï¼š

![39b6db32f6e837d96e2905af314e3cb6.png](vbox-bridge.imgs/39b6db32f6e837d96e2905af314e3cb6.png)

ã€Nextã€‘ã€‚ä½ ä¼šå› ä¸ºæ²¡æœ‰é…ç½‘æ‰€ä»¥ç›´æŽ¥æ¥åˆ°è¿™ä¸ªé¡µé¢ï¼š

![2a0cdbd0621b0b6f7897e0ed85e0cd8d.png](vbox-bridge.imgs/2a0cdbd0621b0b6f7897e0ed85e0cd8d.png)

è¿™ä¸ªé¡µé¢ä¸€èˆ¬é€‰ Server ï¼Œæ¡Œé¢ä»ç„¶æ˜¯å¯ä»¥é€‰æ‹©å®‰è£…çš„ã€‚

ä¸‹ä¸€é¡µé¢æ˜¯åˆ†åŒºã€‚

è¿™é‡Œæˆ‘ä½¿ç”¨å‘å¯¼ï¼š

![ec13279d6470ce5c7e9ab31173244a62.png](vbox-bridge.imgs/ec13279d6470ce5c7e9ab31173244a62.png)

å‘å¯¼ä¸­éœ€è¦æ›´æ”¹çš„åªæœ‰è¿™é‡Œï¼š

![d932e202d4cea192e32fad2cfae6576b.png](vbox-bridge.imgs/d932e202d4cea192e32fad2cfae6576b.png)

å› ä¸ºæˆ‘ä¸æ‰“ç®—ç”¨ `/home` åšæ•°æ®å­˜å‚¨ï¼Œå¹¶ä¸”æƒ³è¦ä½¿ç”¨å¿«ç…§ï¼Œæ‰€ä»¥ç”¨ Btrfs ã€‚

å¦åˆ™å»ºè®®ä¿æŒé»˜è®¤çš„ XFS ã€‚

æ˜¯å¦éœ€è¦å¼€å¯ LVM ä»¥åŠç¡¬ç›˜æ˜¯å¦éœ€è¦åŠ å¯†ä¹Ÿå¯é…Œæƒ…é€‰æ‹©ã€‚

ã€Nextã€‘ã€‚ç„¶åŽå°±æ˜¯æ—¶åŒºé…ç½®ã€‚

![ea12c2e45f62b0d0ae958567d33926bf.png](vbox-bridge.imgs/ea12c2e45f62b0d0ae958567d33926bf.png)

å³ä¸‹è§’ï¼Œã€ Other Settings ã€‘ã€‚

![1fb5f02f9802a5628e231b2a199f1a1c.png](vbox-bridge.imgs/1fb5f02f9802a5628e231b2a199f1a1c.png)


å¦‚æžœä½ å…ˆå‰æŠŠç½‘ç»œé…ç½®æˆåŠŸï¼Œè¿™ä¸ª NTP æœåŠ¡å™¨å°±ä¸èƒ½è‡ªå®šä¹‰äº†ï¼š

![502eda5b625d516e0192ab14b655e688.png](vbox-bridge.imgs/502eda5b625d516e0192ab14b655e688.png)

å¿…é¡»ç½‘ç»œ**ä»Žä¸€å¼€å§‹å°±**ä¸é…ï¼Œç„¶åŽä½ æ‰èƒ½åœ¨è¿™é‡Œè§åˆ°è¿™ä¸ªï¼š

![bef808bb66f70d13c083673093faab34.png](vbox-bridge.imgs/bef808bb66f70d13c083673093faab34.png)

é…æˆä¸‹é¢è¿™æ ·ï¼š

![68c2edbe8940e1a07c0999f12d053a89.png](vbox-bridge.imgs/68c2edbe8940e1a07c0999f12d053a89.png)

ã€Acceptã€‘ï¼Œåœ¨å¤–é¢ï¼Œç‚¹åˆ°ä½ æ‰€åœ¨çš„ä½ç½®ã€‚

![53613b23acc5cb6ad72ef004c86557a2.png](vbox-bridge.imgs/53613b23acc5cb6ad72ef004c86557a2.png)


ã€Nextã€‘ã€‚ä¹‹åŽå°±å¯ä»¥é…ç½®ç”¨æˆ·äº†ã€‚

çŽ°åœ¨å¯ä»¥åŽé€€ï¼Œç”¨ã€Backã€‘é€€å›žåˆ°ä¸€å¼€å§‹é…ç½‘é‚£é‡Œï¼š

![d93c982d76013a2706720674ecc7ecc1.png](vbox-bridge.imgs/d93c982d76013a2706720674ecc7ecc1.png)

##### æ‰‹åŠ¨ç½‘ç»œçš„é…ç½®

åœ¨ç»è¿‡ã€è¯­è¨€é€‰æ‹©ã€‘æ­¥éª¤åŽï¼Œå¦‚æžœå®‰è£…å™¨ä¸èƒ½è‡ªåŠ¨é…é€šå¤–ç½‘ï¼Œå°±ä¼šç»™ä½ è¿™ä¸ªç•Œé¢ï¼š

![1a1d9b614319c9901bd1d6c6eb96fac4.png](vbox-bridge.imgs/1a1d9b614319c9901bd1d6c6eb96fac4.png)

å¦‚æžœæ˜¯è£¸æœºï¼Œä¸Šé¢çš„æ¡†é‡Œå°±å¯èƒ½æœ‰ä¸æ­¢ä¸€ä¸ªè®¾å¤‡ã€‚æˆ‘æ²¡æœ‰å‘çŽ°è¿™ä¸ªç•Œé¢æœ‰å¯¹æ’æ²¡æ’ç½‘çº¿çš„ç½‘å£ï¼ˆè®¾å¤‡ï¼‰åšåŒºåˆ†ï¼Œæ‰€ä»¥ï¼Œè¿™é‡Œåªèƒ½çŒœã€‚

å¯¹ä½ çŒœä¸­çš„ä¸€ä¸ªè®¾å¤‡ä½¿ç”¨ã€Editã€‘ï¼Œæ¥åˆ°è¿™ä¸ªç•Œé¢ï¼š

![5beddc3a31380931a1e3282f0782533b.png](vbox-bridge.imgs/5beddc3a31380931a1e3282f0782533b.png)

éœ€è¦è®¾ç½®çš„å°±åªæœ‰è¿™éƒ¨åˆ†ï¼š

![99399b49b14b1d396cc4e90eef1829f2.png](vbox-bridge.imgs/99399b49b14b1d396cc4e90eef1829f2.png)

å¦å¤–ä¸¤ä¸ªåœ°æ–¹èƒ½è®¾ç½®ä¸€äº›åˆ«çš„ä¸œè¥¿ï¼ˆç”šè‡³æœ‰ MTU è®¾ç½®ï¼‰ï¼Œè¿™é‡Œä¸å±•å¼€ã€‚

ç‚¹ã€Nextã€‘ä¿å­˜è®¾ç½®å¹¶å›žåˆ°ä¹‹å‰é€‰è®¾å¤‡çš„ç•Œé¢ï¼Œã€Backã€‘åˆ™æ˜¯ä¸ä¿å­˜è®¾ç½®ã€‚

æˆ‘ä»¬å·²ç»é…ç½®è¿‡äº†ã€ Hostname/DNS ã€‘ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸‹ï¼Œç„¶åŽé…ç½®ã€ Routing ã€‘ï¼š

![d516443718d2d030418e3c2801447f4c.png](vbox-bridge.imgs/d516443718d2d030418e3c2801447f4c.png)

ç½‘å…³æ˜¯åœ¨è¿™é‡Œé…ç½®çš„ï¼ï¼

è¿™å’Œä½¿ç”¨ `nmcli` ä¸ä¸€æ ·ã€‚

![e29a1d227aa9e2bb61e299fd70b1cb46.png](vbox-bridge.imgs/e29a1d227aa9e2bb61e299fd70b1cb46.png)

ä»ç„¶æ˜¯éœ€è¦é€‰å¯¹è®¾å¤‡ã€‚ï¼ˆå¥½åƒä¸é€‰ä¹Ÿå¯ä»¥ï¼Œä½ å¯ä»¥è¯•è¯•ã€‚ï¼‰

éƒ½å¥½äº†å°±ã€Nextã€‘ã€‚

![9cae3d5c78cc5d4c729048bbae938b3e.png](vbox-bridge.imgs/9cae3d5c78cc5d4c729048bbae938b3e.png)

å¦‚æžœèƒ½çœ‹åˆ°è¿™ä¸ªï¼Œè¯´æ˜Žé€šäº’è”ç½‘äº†ã€‚

ç‚¹ã€ Yes ã€‘å°±ä¼šè¿›å…¥é…ç½®ã€‚**å¹¶ä¸”ï¼Œä¹‹å‰çš„é…ç½‘çš„ç•Œé¢ï¼Œä¸è¦å†è¯•å›¾é€šè¿‡ã€Backã€‘é€€å›žåŽ»äº†**ã€‚å› ä¸ºå¦‚æžœæ”¹åäº†ï¼Œæƒ³æ”¹å¥½ä¹Ÿåªèƒ½åœ¨æœ€åŽæ±‡æ€»é‚£é‡ŒåŽ»æ”¹äº†ã€‚

å…³äºŽæºé€‰æ‹©ï¼Œæˆ‘ç”¨ä¸åˆ°é—­æºæ‰€ä»¥å–æ¶ˆå‹¾é€‰äº† Non-Oss ã€‚

![00677e2c87ad3e9e90562acc6e052f9c.png](vbox-bridge.imgs/00677e2c87ad3e9e90562acc6e052f9c.png)

ã€Nextã€‘ã€‚å¯¼å…¥æºå®ŒæˆåŽå°±æ˜¯è¿™æ ·ï¼š

![bfc518ae42bb214749941f7e5c6e9aaf.png](vbox-bridge.imgs/bfc518ae42bb214749941f7e5c6e9aaf.png)

å’Œä¸é…ç½‘çš„æ—¶å€™çš„ä¸‹ä¸€æ­¥ä¸€æ ·ã€‚

##### æ±‡æ€»

ã€Nextã€‘ä¸‹åŽ»ã€‚ä¸­é—´åˆ«å¿˜äº†æ£€æŸ¥ä½ é…ç½®è¿‡çš„ä¸œè¥¿ï¼Œæ¯”å¦‚åˆ†åŒºé‚£é‡Œã€‚

å†åŽ»çœ‹æŽˆæ—¶æœåŠ¡å™¨çš„é…ç½®ï¼Œå°±æˆäº†ä¸‹é¢è¿™æ ·ä¸èƒ½æ›´æ”¹äº†çš„æ ·å­ã€‚å¯ä»¥ç‚¹åŒæ­¥è¯•è¯•ã€‚

![3bd1a2f0d1962037beb9e44a26188e6f.png](vbox-bridge.imgs/3bd1a2f0d1962037beb9e44a26188e6f.png)

å†ä¸‹ä¸€æ­¥å°±æ˜¯ã€ç”¨æˆ·é…ç½®ã€‘ï¼Œå®ŒæˆåŽå°±æ¥åˆ°ã€æ±‡æ€»ã€‘ï¼š

![c604390adff50e01ce7c093189b1b0a7.png](vbox-bridge.imgs/c604390adff50e01ce7c093189b1b0a7.png)

åœ¨ã€Softwareã€‘é‡Œå¯ä»¥å¢žåŠ å¯¹æ¡Œé¢ã€è™šæœºå·¥å…·çš„é€‰æ‹©ã€‚

ä½ å¯ä»¥è¿™æ ·é€‰æ‹©ï¼š

![7d5fe42753fb76d8d995d3c15568ebb2.png](vbox-bridge.imgs/7d5fe42753fb76d8d995d3c15568ebb2.png)

é…ç½®ä¸å¤Ÿå¯ä»¥é€‰ Xfce æ¡Œé¢ï¼š

![8abc8272bc05a558520ddb505dd0a219.png](vbox-bridge.imgs/8abc8272bc05a558520ddb505dd0a219.png)

ä¸å¤ªå»ºè®®ä½¿ç”¨ KDE æ¡Œé¢ã€‚

ã€Securityã€‘å»ºè®®ä¸è¦åŠ¨ã€‚ `firewall-cmd` ç”¨èµ·æ¥å¾ˆå‚»ç“œï¼Œè€Œä¸”é»˜è®¤æ˜¯æ‰“å¼€ sshd çš„é»˜è®¤ç«¯å£çš„ã€‚

ã€Network Configurationã€‘åœ¨æ­¤å¤„å¯ä»¥å†æ¬¡æ”¹åŠ¨ã€‚

![9566cdad41220a0cac3a863a29636e5e.png](vbox-bridge.imgs/9566cdad41220a0cac3a863a29636e5e.png)

ä½†æ˜¯ï¼š

- å¦‚æžœä¸€å¼€å§‹æ²¡æœ‰é…ç½‘ï¼Œä½ å°±ä¸èƒ½åœ¨å®‰è£…æ—¶é…ç½®ç½‘ç»œæºã€‚
- å¦‚æžœåœ¨ä¸€å¼€å§‹å°±é…å¥½äº†ç½‘ï¼ˆäº’è”ç½‘ï¼‰ï¼Œä½ å°±ä¸èƒ½é…ç½®è‡ªå·±çš„ NTP æœåŠ¡å™¨ã€‚

å®‰è£…è¿‡ç¨‹ä¸­ï¼Œæ©™æ¡†ä¸­æ˜¯å®‰è£…ç›˜æœ¬èº«çš„æºï¼Œä¸‹é¢ä¿©å°±æ˜¯å‰é¢é…çš„ç½‘ç»œæºï¼š

![41fa18f800c9266cd8ef8fa32df36c19.png](vbox-bridge.imgs/41fa18f800c9266cd8ef8fa32df36c19.png)

å®Œæˆå®‰è£…åŽï¼Œå®ƒä¼šè‡ªåŠ¨é‡å¯ã€‚


#### è¯­è¨€

å®‰è£…æ—¶å»ºè®®ä¿æŒé»˜è®¤ï¼š

![52e7362add9928cfe7b1bce6c7dbfbe5.png](vbox-bridge.imgs/52e7362add9928cfe7b1bce6c7dbfbe5.png)

ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä¸€æ–¹é¢æ˜¯ä¸ºäº†è®©å®¶ç›®å½•ä¸‹é‚£å †æ–‡ä»¶å¤¹ä¿æŒè‹±æ–‡ï¼Œä¸€æ–¹é¢æ˜¯ï¼Œé»˜è®¤çš„ç»ˆç«¯ä¸‡ä¸€ä¸æ”¯æŒ UTF-8 ä¸‡å›½ç ï¼Œä¸­æ–‡ï¼Œä¼šæ˜¾ç¤ºæˆé—®å·å°æ–¹å—å„¿çš„â€”â€”æˆ–è€…å°±ç®—èƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œä¹Ÿæ²¡åŠžæ³•è¾“å…¥ã€‚

è¯­è¨€å®‰è£…å®Œå¯ä»¥å†æ”¹ï¼Œè¿™é‡Œå…ˆç”¨è¿™ä¸ªã€‚

æŒ‰ç…§å‰é¢è¯´çš„æ­¥éª¤å®‰è£…ï¼Œç­‰å®ƒå®‰è£…å¥½å¹¶è‡ªåŠ¨é‡å¯å¥½åŽï¼Œè¾“å…¥å¯†ç ç™»å½•ï¼Œå°±æ˜¯è¿™æ ·ï¼š

![7a0299943c7388d78e1a39613585e946.png](vbox-bridge.imgs/7a0299943c7388d78e1a39613585e946.png)

åœ¨èœå•é‡Œæ‰“å¼€ YaST ï¼š

![1d270e54e3e5f3145e56290e56064630.png](vbox-bridge.imgs/1d270e54e3e5f3145e56290e56064630.png)

éœ€è¦è¾“å…¥å¯†ç ã€‚è¾“å…¥åŽç¡®å®šï¼Œå°±æ¥åˆ° YaST ç•Œé¢ã€‚

![1e8e37c64de30ff30c4c4bb669b586f9.png](vbox-bridge.imgs/1e8e37c64de30ff30c4c4bb669b586f9.png)

å³ä¸Šè§’çš„åŠ å·å¯ä»¥æœ€å¤§åŒ–ï¼Œ Search å¤„å¯ä»¥æœç´¢ã€‚

æœç´¢ã€languageã€‘ï¼š

![eb4ea8d768cc754598d20458c3bef566.png](vbox-bridge.imgs/eb4ea8d768cc754598d20458c3bef566.png)

ç‚¹é‚£ä¸ªã€Languageã€‘ï¼Œæ¥åˆ°è¿™ä¸ªç•Œé¢ï¼š

![cee546b61bc4775dfe73fcedae592f77.png](vbox-bridge.imgs/cee546b61bc4775dfe73fcedae592f77.png)

!!! WARNING
    **è¯·æ³¨æ„ï¼šè¿™é‡Œä½œæ”¹åŠ¨ç„¶åŽç‚¹ã€OKã€‘ä¿å­˜æ”¹åŠ¨ä¹‹å‰ï¼Œè¯·åŠ¡å¿…ç¡®ä¿å®ƒèƒ½è¿žäº’è”ç½‘ï¼Œå› ä¸ºæ–°çš„è¯­è¨€æ˜¯ç”¨å®‰è£…è½¯ä»¶çš„åŒ…ç®¡ç†å™¨å®‰è£…çš„ã€‚** å¦‚æžœè”ç½‘å¤±è´¥å¯¼è‡´å®‰è£…å¤±è´¥ï¼Œå¯ä»¥åœ¨**é€šç½‘**çš„æƒ…å†µä¸‹ï¼Œå¯¹è¿™é‡Œçš„è®¾ç½®ç¨ä½œæ”¹åŠ¨ï¼Œç‚¹ã€OKã€‘ï¼Œå†æ”¹æˆä½ æƒ³è¦åº”ç”¨çš„è®¾ç½®ï¼Œç‚¹ã€OKã€‘ï¼Œæ¥è®©å®ƒæ­£ç¡®åœ°ç”Ÿæ•ˆä¸€æ¬¡ã€‚

è¿™é‡Œæˆ‘çš„è®¾ç½®æ˜¯è¿™æ ·ï¼š

![92cd81e847e310a5a5de2e2d462d5337.png](vbox-bridge.imgs/92cd81e847e310a5a5de2e2d462d5337.png)

![debe489aa63a39b7b314b78818c5a647.png](vbox-bridge.imgs/debe489aa63a39b7b314b78818c5a647.png)

![5ef077683350f7114ed6b8e456f5cb0c.png](vbox-bridge.imgs/5ef077683350f7114ed6b8e456f5cb0c.png)

ç‚¹ã€OKã€‘åŽç¨ç­‰ï¼Œå°±ä¼šæ‰“å¼€ä¸‹è½½å¿…è¦å†…å®¹çš„ç•Œé¢ï¼š

![70d40cc95521169b08665b1a01a8cb96.png](vbox-bridge.imgs/70d40cc95521169b08665b1a01a8cb96.png)

![e122838615b3a59408a268e9de9859c1.png](vbox-bridge.imgs/e122838615b3a59408a268e9de9859c1.png)

å¯ä»¥çœ‹åˆ°ï¼Œä¸å…‰å­—ä½“ï¼Œæ‹¼éŸ³è¾“å…¥æ³•å•¥çš„ä¹Ÿä¼šæœ‰ã€‚

![624847d78a1ede6d64f17c2226ede5b1.png](vbox-bridge.imgs/624847d78a1ede6d64f17c2226ede5b1.png)

ç­‰å¾…å®Œæˆå³å¯ã€‚å®ŒæˆåŽéœ€è¦æ‰‹åŠ¨è‡ªè¡Œé‡å¯ä½¿ä¹‹ç”Ÿæ•ˆã€‚

é‡å¯åŽï¼Œé¦–æ¬¡ç™»å½•ç”¨æˆ·ï¼Œä¼šè¢«è¯¢é—®è¦ä¸è¦æŠŠæ¡Œé¢ä¸Šçš„ä¸€å †æ–‡ä»¶å¤¹æ¢æˆä¸­æ–‡åã€‚

ä½†æˆ‘çš„ç›®çš„å°±æ˜¯è®©è¿™äº›ç›®å½•ç”¨è‹±æ–‡å­—æ¯ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä¸æ›´æ”¹ï¼Œä¸”ä¸è®©å®ƒå†è¯¢é—®ã€‚

ï¼ˆä½†ä¸çŸ¥ä¸ºä½•è™šæœºé‡Œå®‰çš„è¿™ä¸ªç³»ç»Ÿå¹¶é—®æˆ‘è¿™ä»¶äº‹â€¦â€¦ä»Žè¡¨çŽ°æ¥çœ‹ä¼¼ä¹Žè¯­è¨€é…ç½®ä¹Ÿåªæ˜¯éƒ¨åˆ†åœ°å®Œæˆäº†è€Œå·²ã€‚ï¼‰

ä»¥åŠï¼Œè¿˜æœ‰åˆ«çš„èƒ½å¤ŸæŽ¢æµ‹ç³»ç»Ÿè¯­è¨€å¹¶åŸºäºŽæ­¤ä¼šæœ‰ä¸åŒè¡¨çŽ°çš„è½¯ä»¶ï¼Œä»Žè¿™ä¹‹åŽï¼Œå°±ä¼šä»¥åœ¨ä¸­æ–‡ç³»ç»Ÿä¸­çš„é€»è¾‘è¿è¡Œäº†ã€‚æ¯”å¦‚ Network Manager ä¼šç»™æ–°åŠ ç½‘å¡äºˆä»¥ä¸­æ–‡å‘½åï¼ˆè¿™é‡Œé¢å¯èƒ½ä¹Ÿæœ‰æ¡Œé¢çš„åŽŸå› ï¼‰ã€‚






### Snapper

#### åŸºæœ¬

##### é…ç½®

é…ç½®ç±»ä¼¼äºŽ Kubernetes çš„ _å‘½åç©ºé—´_ ä¸€æ ·çš„ä¸œè¥¿ã€‚

é»˜è®¤ä½¿ç”¨ `snapper list` æŸ¥çœ‹éƒ½æœ‰å“ªäº›å¿«ç…§æ—¶ï¼Œç­‰åŒäºŽ `snapper -c root list` ï¼Œå³é€‰ç”¨ `root` é…ç½®ã€‚

ä¸€ä¸ªé…ç½®å¯¹åº”ä¸€ä¸ªå·ï¼ˆåœ¨è¿™é‡Œå°±æ˜¯ Btrfs å·ï¼‰ã€‚

çœ‹éƒ½æœ‰å“ªäº›é…ç½®ï¼š `snapper list-configs`

åˆ›å»ºä¸€ä¸ªé…ç½®ï¼š `snapper -c home create-config -- /home`

åŸºäºŽä¸€ä¸ªé…ç½®åšäº›ä»€ä¹ˆï¼š

- `snapper -c home create -t single --description 'home snap born' --userdata important=yes`
- `snapper -c root create -t single --description 'root snap born' --userdata important=yes`

å…¶ä¸­ `-c root` é»˜è®¤å¯çœç•¥ã€‚

#### å¯¹ä¸€å †å‘½ä»¤æ‰“å¿«ç…§

ä¼šæ›´æ”¹ç³»ç»Ÿæ–‡ä»¶çš„è¡Œä¸ºï¼Œå»ºè®®éƒ½åŸºäºŽè¿™ä¸ªå‘½ä»¤æ¥æ‰§è¡Œï¼Œä»¥ä¾¿åŽç»­è¿½è¸ªã€‚

##### éœ€è¦çš„å‘½ä»¤

~~~~ bash
snapper create -d 'desc' --command 'commands'
~~~~

å¦‚æžœæ˜¯ä¸€å †å‘½ä»¤ï¼Œå¯ä»¥å…ˆæŠŠé‚£å †å‘½ä»¤åšæˆå‡½æ•°ï¼Œç„¶åŽåˆ©ç”¨ `declare -f` è®©å®ƒåœ¨é‡Œé¢è°ƒç”¨ã€‚ï¼ˆç±»ä¼¼çš„æ‰‹æ®µ `export -f` åœ¨è¿™é‡Œä¸é€‚ç”¨ï¼šå¯èƒ½æ˜¯å› ä¸ºä¸Šé¢çš„å‘½ä»¤å¹¶ä¸æ˜¯ä½œä¸ºå½“å‰è¿›ç¨‹çš„å­è¿›ç¨‹æ¥è¿è¡Œçš„ã€‚ï¼‰

##### ç¤ºä¾‹

å®šä¹‰ï¼š

~~~~ bash
ask_user ()
{
    predesc="${1:-Hey ðŸ‘»}"
    ask="${2:-what should i ask ???}" &&
    anss="${3:-[y/n] (:p)}" &&
    
    cases="${4:-
        case \"\$ans\" in 
            
            y|\'\') echo ðŸ˜¦ yup\?\? ; break ;; 
            n) echo ðŸ¤” no\? ; break ;; 
            *) echo ðŸ¤¨ ahh\? what is \'\$"{"ans:-:p"}"\' \? ;; esac }" &&
    
    
    echo "$predesc" &&
    while read -p "$ask $anss " -- ans ;
    do eval "$cases" ; done ;
} ;

uuid_xfstab__ ()
{
    local rt ;
    
    case "$#" in 1|2) ;; *) 1>&2 echo need one or two args ; return 4 ;; esac ;
    
    : ::::::::::::::::: : ;
    
    dev_uuid ()
    {
        local device="$1" &&
        local field="$2" &&
        (eval "$(blkid -o export -- "$device")"' ; echo $'"${field:-UUID}") ;
    } &&
    
    uuid_fstab ()
    {
        local device="$1" &&
        local dir="${2:-/var/lib/docker}" &&
        
        echo UUID="$(
            dev_uuid "$device" UUID )"  "${dir:-/var/lib/containers}"  "$(
            dev_uuid "$device" TYPE )"  defaults,pquota  0 0 ;
    } &&
    
    : ::::::::::::::::: : &&
    
    local device="$1" &&
    local dir="${2:-/var/lib/libvirt/images/pool0}" &&
    
    mkdir -p -- "$dir" &&
    
    : ä¸‹è¾¹éƒ½æ˜¯å¦‚æžœå›žç­” n å°±é€€å‡º'(quit)' uuid_xfstab__ å¦åˆ™å°±ä¼šæ‰§è¡Œåˆ°ä¸‹è¾¹ &&
    
    {
        ask_user "
$(lsblk)

============

: got 
: 
:   dev: $device 
:   dir: $dir 
" ": make the $device in to xfs ? will clear datas in it ~~ ðŸ˜¬" "[y/n]" '
            
            case "$ans" in 
                y) echo ; return 0 ;; 
                n) echo : quit tool ðŸ˜‹ ; return 2 ;;
                *) ;; esac ' || return ;
        
        mkfs -t xfs -n ftype=1 -f -- "$device" ;
        
    } &&
    
    
    {
        ask_user "
: will add this line to fstab:
$(uuid_fstab "$device" "$dir")
" ': ðŸ¤” go on ?' '[y/n]' '
            
            case "$ans" in
                y) echo ; return 0 ;;
                n) echo : quit tool ðŸ˜˜ ; return 2 ;;
                *) ;; esac ' || return ;
        
        (echo ; uuid_fstab "$device" "$dir" ; echo) | tee -a -- /etc/fstab ;
        
    } &&
    
    
    mount -a ||
    { rt=$? ; echo ðŸ˜¨ may need to check /etc/fstab and recmd mount -a ; return $rt ; } ;
    
    lsblk &&
    
    :;
} ;
~~~~

ä¸Šé¢æœ‰ä¸¤ä¸ªå‡½æ•°ã€‚ [`ask_user`](https://github.com/hmrg-grmh/meta-shells/tree/main/dialec-cmdline) å¯ä»¥å½“æˆæ˜¯ä¸€ä¸ªè¢«ä½¿ç”¨çš„åº“ï¼Œæˆ‘åœ¨ `uuid_xfstab__` çš„å®šä¹‰ä¸­ä½¿ç”¨äº†å®ƒï¼ŒåŽè€…åˆ™èƒ½åœ¨ä¸€ä¸ªæœ‰é—®è¯é˜»å¡žçš„å­—ç¬¦ç•Œé¢ï¼Œåœ¨ç»è¿‡ç”¨æˆ·æ£€æŸ¥å¹¶åŒæ„åŽï¼Œåšå‡ºç›¸åº”æ“ä½œã€‚


ä½¿ç”¨ï¼š

~~~~ bash
snapper create -d 'add a fstab data-volme for /var/lib/libvirt/images/pool2 use xfs' --command "$(declare -f -- ask_user uuid_xfstab__) ; "'uuid_xfstab__ /dev/sdi /var/lib/libvirt/images/pool2'
~~~~

è¿™å¹¶ä¸ä¼šå½±å“äº¤äº’çš„åŠŸèƒ½ï¼Œä¸€åˆ‡éƒ½è¿è¡Œè‰¯å¥½ã€‚æˆ‘é€šè¿‡è¿™ä¸ªï¼Œå¯ä»¥ä¸ºç‰¹å®šç›®å½•æŒ‚è½½ç‰¹å®šçš„ç›˜â€”â€”æ ¼å¼åŒ–å’Œå¯¹ `/etc/fstab` çš„æ›´æ”¹éƒ½æ˜¯åœ¨è¯¢é—®è¦ä¸è¦åšå¹¶å¾—åˆ°è‚¯å®šç­”å¤åŽè‡ªåŠ¨å®Œæˆçš„ã€‚

åº“ `ask_user` ä¸­ä½¿ç”¨äº† `eval` æ¥è¾¾åˆ°å…ƒç¼–ç¨‹çš„æ•ˆæžœï¼Œåœ¨æ­¤å¤„ï¼ˆ `snapper crate --command cmds` ï¼‰ä¹Ÿæ˜¯å®Œå¥½è¿è¡Œçš„ã€‚







# :: EOF ::


<!-- <style class="fallback">body{visibility:hidden}</style><script>markdeepOptions={tocStyle:'long'};</script> -->
<!-- Markdeep: -->
<!-- <script src="https://casual-effects.com/markdeep/latest/markdeep.min.js?" charset="utf-8"></script> -->
